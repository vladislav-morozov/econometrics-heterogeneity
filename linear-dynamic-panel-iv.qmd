# Interlude: Standard Dynamic Panel Estimators


::: {.callout-note appearance="simple" icon=false}

## Summary and Learning Outcomes
 
One-sentence summary and learning outcomes

:::

## Exogeneity and Dynamic Models

### Introduction

Throughout the previous section, we assumed that the idiosyncratic term $u_{it}$ satisfied strict exogeneity with respect to the data:
$$
	\E[u_{it}|\bX_i] = 0.
$${#eq-dynamic-interlude-strict-orthogonality}

However, strict exogeneity is not an innocent assumption. In particular, it implies that for all pairs of indices $t, s$ it holds that 
$$
	\E[u_{it}\bx_{is}] =0.
$$ {#eq-dynamic-interlude-strict-orthogonality}

If we take $t<s$, @eq-dynamic-interlude-strict-orthogonality means that  *past* shocks are uncorrelated with *future* values of $\bx$ or, intuitively, that one cannot predict *past* shocks from *future* $\bx$s. 

This requirement might fail if $\bx$ is dynamic and its evolution is affected by $u_{it}$. In this section, we will discuss this challenge and some traditional approaches to dealing with it with short panel data. 

### No Strict Exogeneity for Dynamic Models


A particularly clear example for failure of @eq-dynamic-interlude-strict-orthogonality arises when $\bx_{it}$ includes lagged values of the outcome. As we show now, strict exogeneity cannot hold in this case. 


For simplicity, we momentarily forget about the cross-sectional dimension consider a simple autoregressive model with 1 lag (AR(1)):
$$
	y_t = \alpha + \lambda y_{t-1} + u_{t},
$$
where  $t=1, \dots, T$ and the innovation $u_t$ satisfies $\E[u_t]=0$. 

 
To show that strict exogeneity fails, it is sufficient to find a single pair of $(t, s)$ such that @eq-dynamic-interlude-strict-orthogonality  is not true. Specifically, we will take $s=t+1$ and show that  $\E[y_{it+1}u_t]$ is not necessarily zero.

To evaluate this expectation, we write the model at $t+1$
$$
	y_{t+1} = \alpha + \lambda y_t + u_{t+1}.
$$ {#eq-dynamic-interlude-simple-ar1}
We then substitute the model into $\E[y_{it+1}u_t]$
$$
\begin{aligned}
	\E[y_{t+1}u_t] & = \lambda\E[y_t u_t] + \E[u_{t+1}u_t] \\
	&  = \lambda^2\E[y_{t-1}u_t] + \lambda\E[u_t^2] + \E[u_{t+1}u_t] .
\end{aligned}
$$

What can we say about the right hand side? In many contexts, we may reasonably assume that

- One cannot predict the shocks of tomorrow from what you have today, so that $$\E[y_{t-1}u_t]=0.$$
- $u_{t}$ is uncorrelated over time, so that $$\E[u_{t+1}u_t]=0.$$ 

However, $\lambda\E[u_t^2]$ is zero only in two unreasonable cases: 

- If $\lambda=0$, and so the model is not actually dynamic
- $\E[u_t^2]=0$, and so the process is actually fully deterministic. 

Both of these options are unpleasant. The first one goes against the idea of allowing any dynamics. The second is extremely unlikely with any kind of social data. We conclude that in dynamic models it is the case
$$
\E[y_{it+1}u_t] \neq 0.
$$ {#eq-dynamic-interlude-no-strict-exogeneity}
A fortiori, strict exogeneity also cannot hold in dynamic models. 

### Sequential Exogeneity

So what can you do if you want to allow for dynamic models? Since strict exogeneity ([-@eq-dynamic-interlude-strict-orthogonality]) is effectively impossible to satisfy, we need a weaker form of exogeneity. 

One popular weaker assumption compatible with dynamic models is *sequential exogeneity* (or *predeterminedness*). In context of the simple univariate time series model ([-@eq-dynamic-interlude-simple-ar1]), sequential exogeneity may be stated as 
$$
		\E[u_{t}| y_{t-1}, y_{t-2}, \dots] =0.
$$
Intuitively, sequential exogeneity states that future shocks cannot be predicted  using past covariates. However, it does not restrict our ability to predict the past from the future â€” the context which created problems for strict exogeneity. 

More generally, consider a panel data linear model with homogeneous coefficients, a random intercept, and a dynamic process for the outcome:
$$
y_{it} = \alpha_i + \sum_{k=1}^K \lambda_k y_{it-k} + \bbeta'\bx_{it} + u_{it}.  
$$ {#eq-dynamic-interlude-dynamic-panel}
In this model, a sequential exogeneity assumption takes form
$$
	 \E[u_{it}|\curl{y_{is-1}, \bx_{is}}_{s\leq t}] =0. 
$$
Model ([-@eq-dynamic-interlude-dynamic-panel]) is a dynamic counterpart of the static model ([-@eq-within-lecture-random-intercept]) we discussed in the last section.  

## Handling Dynamic Panels with a Random Intercept
 
Before moving on and introducing heterogeneous coefficients in dynamic linear models, we will discuss model ([-@eq-dynamic-interlude-dynamic-panel]) in more detail. In particular, we will develop the standard workhorse instrumental variable estimators. We will  analyze how these estimators fare in the more general model ([-@eq-lecture_model]) in the next section.
 
 

### Model

For the sake of simplicity, we will discuss a simple version of model ([-@eq-dynamic-interlude-dynamic-panel]) without extra covariates $\bx_{it}$ and with only one lag of $y_{it}$:
$$
y_{it} = \alpha_i + \lambda y_{it-1} + u_{it}, 
$$
where $u_{it}$ satisfies sequential exogeneity in the form $\E[u_{it}|y_{is}, s<t] = 0$. This random intercept dynamic model has extensively considered in the literature [e.g. @Anderson1982; @Arellano1991; @Blundell1998].

The key parameter of interest is $\lambda$. By homogeneity of $\lambda$, it also plays the role of the average coefficient for model ([-@eq-dynamic-interlude-dynamic-panel]).

Here, we will primarily focus on the large-$N$, fixed-$T$ case, though model ([-@eq-dynamic-interlude-dynamic-panel]) has also been extensively studied in the large-($N, T$)  case [e.g. @Alvarez2003].

### Endogeneity


To work towards an estimator for $\lambda$, let us difference @eq-dynamic-interlude-dynamic-panel across $t$ to eliminate the random intercept $\alpha_i$. The differenced equation takes form
$$
\begin{aligned}
\Delta y_{it} & = \lambda \Delta y_{it-1} + \Delta u_{it}, \\
\Delta y_{it} & = y_{it} - y_{it-1}.
\end{aligned}
$$ {#eq-dynamic-interlude-homogeneous-differenced}
@eq-dynamic-interlude-homogeneous-differenced seems like a simple regression equation. It is tempting to just apply OLS and regress $\Delta y_{it}$ on $\Delta y_{it-1}$.

It turns out that this approach will fail as there is an endogeneity problem in @eq-dynamic-interlude-homogeneous-differenced! Sequential exogeneity is not enough to guarantee that
$$
\E[\Delta y_{it-1}\Delta u_{it}] = 0.
$$

To see why, we expand $\E[\Delta y_{it-1}\Delta u_{it}]$ as  
$$
\begin{aligned} 
	& \E\left[(u_{it}-u_{it-1})(y_{it-1}-y_{it-2}) \right] \\
	& = \E[ u_{it}y_{it-1} ] + \E[(u_{it-1}-u_{it})y_{it-2}] - \E[u_{it-1}y_{it-1}]  \\
	& = -\E[u_{it-1} y_{it-1}].
\end{aligned}
$$
Sequential exogeneity is sufficient to immediately eliminate 3 out of 4 expectations. For the last expectation remaining, we can substitute $y_{it-1}$ to see that 
$$
\begin{aligned}
	\E[u_{it-1}y_{it-1}] & = \lambda\E[u_{it-1}y_{it-2}] + \E[u_{it-1}^2]\\
	& = \E[u_{it-1}^2]
\end{aligned}
$$
As noted above, in general we expect that $\E[u_{it-1}^2] \neq 0$. Hence  we conclude that 
$$
	\E[\Delta y_{it-1}\Delta u_{it}]\neq 0.
$$ {#eq-dynamic-interlude-differenced-endogeneity}
In other words,  $\Delta y_{it-1}$ is an endogenous regressor in the differenced @eq-dynamic-interlude-homogeneous-differenced. 

::: {.callout-caution appearance=minimal}

One should not confuse the endogeneity in @eq-dynamic-interlude-differenced-endogeneity with the failure of *strict* exogeneity in dynamic models (e.g. @eq-dynamic-interlude-no-strict-exogeneity).
:::


## IV Estimation of Dynamic Panel Models




## Extra: Endogeneity and the Within Estimator

