# Intro: Linear Models with Heterogeneous Coefficients

## Linearity and Heterogeneity

### Towards Heterogeneous Coefficients

Standard linear models found in textbooks (e.g., @Hansen2022) often assume homogeneity in individual responses to covariates. For cross-sectional data, a typical specification is:

$$
y_i = \bbeta'\bx_i + u_{i},
$$ {#eq-standard_linear}
where $i=1, \dots, N$ indexes cross-sectional units. 

For panel data, models commonly incorporate individual-specific $(i)$ and time-specific $(t)$ intercepts while maintaining a common slope vector $\bbeta$:

$$
y_{it} = \alpha_i + \delta_t +  \bbeta'\bx_{it} + u_{it}.
$$ {#eq-panel_linear}
One may also incorporate more complex forms of random intercepts. Here $i=1,\dots, N$ indexes cross-sectional units, clusters, etc.; $t=1, \dots, T$  indexes the length of time series $i$, the size of cluster $t$, etc. 

However, economic theory rarely justifies a common $\bbeta$ across all units. More flexible models allow for heterogeneous coefficients:

1. Cross-sectional model with individual-specific slope parameters:

   $$
y_i = \bbeta_{i}'\bx + u_i.
   $$ {#eq-cross_sectional_hetero}

2. Panel model with individual- and time-specific slope parameters:

   $$
y_{it}  = \bbeta_{it}'\bx_{it} + u_{it}.
   $$ {#eq-panel_hetero}

### Examples

Models [-@eq-cross_sectional_hetero] and [-@eq-panel_hetero] arise in a variety of contexts:

- **Binary covariates and interaction terms:** In models with fully interacted binary covariates, heterogeneous coefficients arise naturally without loss of generality (see, e.g., @Wooldridge2005).  
  *Empirical example:* Estimating the effect of smoking during pregnancy on infant birth weight (@Arellano2012).

- **Structural models with parameter restrictions:** Certain parametric restrictions yield linear relationships in coefficients.  
  *Empirical example:* Firm-level Cobb-Douglas production functions where firm-specific productivity differences induce heterogeneous coefficients (@Combes2012b; @Sury2011).

- **Log-linearized models:** Nonlinear models may be approximated by linear models around a steady-state.  
  *Empirical example:* @Heckman1998 demonstrate how the nonlinear @Card2001 education model simplifies to a heterogeneous linear specification after linearization.

### What Do We Care About?

Key parameters of interest in heterogeneous linear models include:

- **Individual effects:** The coefficient vector $\bbeta_i$ for specific units.
- **Moments of the distribution:** Mean ($\mathbb{E}[\bbeta_i]$), variance, and higher-order moments.
- **Distributional properties:** The full distribution of $\bbeta_i$ or its quantiles, or just the tail behavior of the distribution.

Similar objects are relevant for the panel model in
@eq-panel_hetero.

### Key Challenges

Models
@eq-cross_sectional_hetero and
@eq-panel_hetero are often too general for direct identification of parameters. Key challenges include:

1. **Limited observations per coefficient vector:** Since each unit $i$ (or pair $(i,t)$) provides only indirect information through $\bbeta_i'\bx_i$ (or $\bbeta_{it}'\bx_{it}$), individual parameters are not directly observed.
2. **Unrestricted dependence between coefficients and covariates:** Without assumptions on the relationship between $\bbeta_i$ and $\bx_i$, identification is difficult.

### Identification Strategies

To estimate parameters of interest, common identification strategies include:

- **Restricting coefficient variation:**
  - In panel settings, assuming time-invariant coefficients simplifies
    @eq-panel_hetero to:
    
    $$
y_{it} = \bbeta_i'\bx_{it} + u_{it}.
    $$ {#eq-time_invariant}
    
  - Alternative approaches assume a finite number of latent groups, each with its own coefficient vector, yielding the grouped structure:
    
    $$
y_{it} = \bbeta_{g_i, t}'\bx_{it} + u_{it},
    $$ {#eq-grouped_model}
    
    studied in @Bonhomme2015, @Bester2016, and @Bonhomme2022DiscretizingUnobservedHeterogeneity.

- **Restricting dependence between $\bbeta_i$ and $\bx_i$:**
  - Assuming independence between $\bbeta_i$ and $\bx_i$ enables identification of the full distribution of $\bbeta_i$ (see @Hoderlein2010 for the cross-sectional case in
    @eq-cross_sectional_hetero).

By leveraging these assumptions, researchers can recover meaningful insights from heterogeneous linear models.

## Key Model

### Panel Model with Time-Invariant Coefficients

In this block of lectures, we focus on the linear panel model with time-invariant heterogeneous coefficients:

$$
y_{it} = \bbeta_i'\bx_{it} + u_{it}.
$$ {#eq-lecture_model}

We primarily adopt the **fixed effects (FE) approach**, which avoids imposing assumptions on the distribution of $\bbeta_i$ or its dependence with $\bx_{it}$. A key advantage of this approach is its flexibilityâ€”it allows for arbitrary dependence between covariates and individual-specific coefficients. This means economic agents can select their covariates $\bx_{it}$ based on knowledge of their own $\bbeta_i$, which is a common feature of observational data.

### A Special Case: The Random Intercept Model

A widely used special case of the panel model is the **random intercept model**, which serves as a foundation for handling unobserved heterogeneity in applied work. The one-dimensional version takes the form:

$$
y_{it} = \alpha_i + \bbeta'\bx_{it} + u_{it}.
$$ {#eq-random_intercept}

Here, $\bbeta$ is a common coefficient vector applied to the covariates, while $\alpha_i$ represents individual-specific intercepts. Despite being called a "fixed effect," $\alpha_i$ is typically treated as a random variable, often leading to confusion. This model dates back to @Mundlak1961EmpiricalProductionFunction and can be extended to accommodate multiple random intercepts, such as in settings with firm $\times$ industry $\times$ time structures.

## Plan for This Block

This block of lectures explores the following key topics:

1. **Assessing Standard Estimators Under Heterogeneity:**  
   - We analyze whether conventional estimators for the random intercept mode @eq-random_intercept} can consistently estimate **average effects** in the presence of heterogeneous coefficients.  
   - We distinguish between **static** and **dynamic** cases:
     - In static settings, we examine the **within estimator** (a.k.a. "fixed effects estimator") and establish conditions under which it consistently estimates $\mathbb{E}[\bbeta_i]$.
     - In dynamic settings, we explore instrumental variable (IV) estimators and demonstrate why they fail to be consistent for the average effect under coefficient heterogeneity.

2. **Introducing a Robust Mean Group Estimator:**  
   - We discuss an estimator for $\mathbb{E}[\bbeta_i]$ that remains valid without requiring assumptions on the joint distribution of $\bbeta_i$ and $\bx_i$. This method is applicable in both static and dynamic contexts.

3. **Variance Estimation in a Fixed Effects Framework:**  
   - We derive an estimator for the variance of $\bbeta_i$, extending the analysis beyond just average effects.

4. **Identifying the Full Distribution of $\bbeta_i$:**  
   - We explore methods for recovering the entire distribution of $\bbeta_i$ under a fixed effects framework, introducing deconvolution techniques as a key tool.
 