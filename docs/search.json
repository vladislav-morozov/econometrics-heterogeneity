[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Econometrics with Unobserved Heterogeneity",
    "section": "",
    "text": "Econometrics Heterogeneity",
    "crumbs": [
      "Econometrics Heterogeneity"
    ]
  },
  {
    "objectID": "index.html#what",
    "href": "index.html#what",
    "title": "Econometrics with Unobserved Heterogeneity",
    "section": "What",
    "text": "What",
    "crumbs": [
      "Econometrics Heterogeneity"
    ]
  },
  {
    "objectID": "index.html#for-whom",
    "href": "index.html#for-whom",
    "title": "Econometrics with Unobserved Heterogeneity",
    "section": "For Whom",
    "text": "For Whom",
    "crumbs": [
      "Econometrics Heterogeneity"
    ]
  },
  {
    "objectID": "index.html#why",
    "href": "index.html#why",
    "title": "Econometrics with Unobserved Heterogeneity",
    "section": "Why",
    "text": "Why",
    "crumbs": [
      "Econometrics Heterogeneity"
    ]
  },
  {
    "objectID": "index.html#course-plan",
    "href": "index.html#course-plan",
    "title": "Econometrics with Unobserved Heterogeneity",
    "section": "Course Plan",
    "text": "Course Plan",
    "crumbs": [
      "Econometrics Heterogeneity"
    ]
  },
  {
    "objectID": "index.html#learning-outcomes",
    "href": "index.html#learning-outcomes",
    "title": "Econometrics with Unobserved Heterogeneity",
    "section": "Learning Outcomes",
    "text": "Learning Outcomes",
    "crumbs": [
      "Econometrics Heterogeneity"
    ]
  },
  {
    "objectID": "index.html#about-these-notes",
    "href": "index.html#about-these-notes",
    "title": "Econometrics with Unobserved Heterogeneity",
    "section": "About These Notes",
    "text": "About These Notes\nMeanwhile, you may find the lecture slides here:\n\nA\nB\nC",
    "crumbs": [
      "Econometrics Heterogeneity"
    ]
  },
  {
    "objectID": "index.html#current-state",
    "href": "index.html#current-state",
    "title": "Econometrics with Unobserved Heterogeneity",
    "section": "Current State",
    "text": "Current State",
    "crumbs": [
      "Econometrics Heterogeneity"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "1.1 Unobserved Heterogeneity and Its Types\nA general feature of data is that economic agents differ in unobserved ways. Among such differences, we can highlight the following (overlapping) types of unobserved heterogeneity:",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#unobserved-heterogeneity-and-its-types",
    "href": "intro.html#unobserved-heterogeneity-and-its-types",
    "title": "1  Introduction",
    "section": "",
    "text": "1.1.1 Missing Variables\n\n\n1.1.2 “Fundamental” Characteristics\n\n\n1.1.3 Differences in Responses\n\n\n1.1.4 Measurement Error\n\nMissing explanatory variables.\n\nExample: demand estimation. Consumer demand depends on the prices of goods, and agents in different areas may face different price vectors. However, if the data does not capture prices, they form part of the unobserved differences between consumers.\n\n``Fundamental’’ characteristics of agents.\n\n{Example}: demand estimation. Consumer demand also depends on preferences. Preferences are usually different between people and not observed. % As preferences are encoded using utility functions, a person’s utility function forms part of their unobserved heterogeneity. % Unobserved heterogeneity arises for many reasons: things not captured by data (you have seen omitted variable bias); some ``deep’’ differences such as preferences (expressed often in terms of coefficients); measurement error;\nDifferences in responses to changes in treatments (explanatory variables). % This encompasses treatment effect heterogeneity, heterogeneous coefficients, and differences in functional forms across individuals and groups.\n{Example}: impact of job training. A person’s individual treatment effect is the difference between what their earnings would have been after completing the training and their earnings without completing the training. Some people may benefit more from the program, leading to treatment effect heterogeneity. % However, the individual effect is not observed, as each person is only seen in the treated or untreated state.\n\nMeasurement error in variables.\n\n{Example}: an individual’s intellectual ability affects their earnings. Sometimes test scores are used a proxy for true ability. However, scores provide a noisy measurement of ability. The difference between the two (measurement error) is an unobserved individual-specific variable.\n\n\n\n\n1.1.5 Commun?\nAll of the above cases are variations of the same problem: there exist unobserved variables.\nIn practically any observational setting, these unobserved differences will affect both outcomes and the observed explanatory variables.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#consequences-of-ignoring-unobserved-heterogeneity",
    "href": "intro.html#consequences-of-ignoring-unobserved-heterogeneity",
    "title": "1  Introduction",
    "section": "1.2 Consequences of Ignoring Unobserved Heterogeneity",
    "text": "1.2 Consequences of Ignoring Unobserved Heterogeneity\nIgnoring or misspecifying such unobserved factors may invalidate identification, estimation and inference, particularly with non-experimental (observational) data. Such issues affect even simple models such as linear regression, and some examples are covered in introductory econometrics texts. In particular, not including an important explanatory variable leads to omitted variable bias and inconsistency of OLS. Likewise, not accounting for the presence of measurement error in the explanatory variable leads to attenuation bias in the regression coefficients.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#this-course",
    "href": "intro.html#this-course",
    "title": "1  Introduction",
    "section": "1.3 This Course",
    "text": "1.3 This Course\nAs a response, a large amount of effort has been dedicated to developing credible statistical procedures which account for unobserved heterogeneity in causal settings.\nThese lecture notes discuss some selected advances from this literature. Specifically, the course is divided in three blocks:",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "syllabus.html",
    "href": "syllabus.html",
    "title": "2  Syllabus",
    "section": "",
    "text": "2.1 Course Information\nInstructor: Vladislav Morozov\nEmail: morozov [at] uni-bonn.de\nLevel: Second-year Master’s and PhD students\nPrerequisites: first-year graduate sequence, including microeconometrics",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Syllabus</span>"
    ]
  },
  {
    "objectID": "syllabus.html#course-content",
    "href": "syllabus.html#course-content",
    "title": "2  Syllabus",
    "section": "2.2 Course Content",
    "text": "2.2 Course Content\n\n2.2.1 Short Description\nUnobserved heterogeneity is pervasive in economics, driven by heterogeneous parameters and treatment effects, unobserved characteristics of agents, missing variables, etc. This class introduces methods for estimating parameters of interest in settings with such unobserved heterogeneity.\nThe course is structured into three main parts:\n\nLinear models with heterogeneous coefficients\nNonparametric models with unobserved heterogeneity\nQuantile and distributional treatment effects. Quantile and distributional regression methods.\n\nThis class focuses on observational cross-sectional and panel data settings.\n\n\n2.2.2 Syllabus\nSubject to modification based on progress and interest\nBlock 0: Introduction to Unobserved Heterogeneity\n\nDefinition and a brief classification\nExamples in applied econometrics\nOverview of key methodological challenges\n\nBlock 1: Linear Models with Heterogeneous Coefficients\n\nLinear models and their applicability\n\nHeterogeneity in linear models\n\nAverage effects:\n\nIssues with the within estimator under heterogeneity\n\nInterlude: Dynamic panels with random intercepts\n\nIssues with dynamic panel IV estimators under heterogeneity\n\nRobust estimation with the mean group estimator\n\n\nVariance of coefficients\n\nDistribution of coefficients:\n\nA primer on deconvolution\n\nIdentification of the distribution\n\nEstimation with discrete covariates\n\n\nBlock 2: Nonparametric Models with Unobserved Heterogeneity\n\nA partial classification of nonparametric models with unobserved heterogeneity\n\nIntroduction to nonseparable models\n\nHeterogeneity bias and issues with identification in cross-sectional settings\n\nIdentification and estimation of average marginal effects in fully nonseparable models with panel data:\n\nIdentification for stayers under strong stationarity\n\nExtending identification results beyond stayers\n\nAccommodating changes in the structural function\n\n\nVariance of marginal effects in nonseparable models\n\nBlock 3: Quantile and Distribution Treatment Effects:\n\nBackground: Quantiles and their properties\n\nCausal framework: Quantile and distributional treatment effects and their interpretation\n\nIdentification of QTEs and DTEs under unconfoundedness\n\nMethods:\n\nQuantile regression:\n\nGeneral formulation\n\nWhen is quantile regression correctly specified?\n\nQuantile crossing and rearrangement techniques\n\n\nDistribution regression:\n\nGeneral formulation\n\nRearrangement for distribution regression\n\n\n\nEstimation of QTEs and DTEs\n\nWhat can quantile regressions tell us about nonseparable models?\n\nBlock 4 Student Presentations",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Syllabus</span>"
    ]
  },
  {
    "objectID": "syllabus.html#course-materials",
    "href": "syllabus.html#course-materials",
    "title": "2  Syllabus",
    "section": "2.3 Course Materials",
    "text": "2.3 Course Materials\nTextbook: None. The course is based on lecture notes and background articles.\nRecommended Readings: Please see the bibliography for a detailed reading list.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Syllabus</span>"
    ]
  },
  {
    "objectID": "linear-introduction.html",
    "href": "linear-introduction.html",
    "title": "3  Intro: Linear Models with Heterogeneous Coefficients",
    "section": "",
    "text": "3.1 Linearity and Heterogeneity",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Intro: Linear Models with Heterogeneous Coefficients</span>"
    ]
  },
  {
    "objectID": "linear-introduction.html#linearity-and-heterogeneity",
    "href": "linear-introduction.html#linearity-and-heterogeneity",
    "title": "3  Intro: Linear Models with Heterogeneous Coefficients",
    "section": "",
    "text": "3.1.1 Towards Heterogeneous Coefficients\nStandard linear models found in textbooks (e.g., Hansen (2022)) often assume homogeneity in individual responses to covariates. For cross-sectional data, a typical specification is:\n\\[\ny_i = \\bbeta'\\bx_i + u_{i},\n\\tag{3.1}\\] where \\(i=1, \\dots, N\\) indexes cross-sectional units.\nFor panel data, models commonly incorporate individual-specific \\((i)\\) and time-specific \\((t)\\) intercepts while maintaining a common slope vector \\(\\bbeta\\):\n\\[\ny_{it} = \\alpha_i + \\delta_t +  \\bbeta'\\bx_{it} + u_{it}.\n\\tag{3.2}\\] One may also incorporate more complex forms of random intercepts. Here \\(i=1,\\dots, N\\) indexes cross-sectional units, clusters, etc.; \\(t=1, \\dots, T\\) indexes the length of time series \\(i\\), the size of cluster \\(t\\), etc.\nHowever, economic theory rarely justifies a common \\(\\bbeta\\) across all units. More flexible models allow for heterogeneous coefficients:\n\nCross-sectional model with individual-specific slope parameters:\n\\[\ny_i = \\bbeta_{i}'\\bx + u_i.\n\\tag{3.3}\\]\nPanel model with individual- and time-specific slope parameters:\n\\[\ny_{it}  = \\bbeta_{it}'\\bx_{it} + u_{it}.\n\\tag{3.4}\\]\n\n\n\n3.1.2 Examples\nModels 3.3 and 3.4 arise in a variety of contexts:\n\nBinary covariates and interaction terms: In models with fully interacted binary covariates, heterogeneous coefficients arise naturally without loss of generality (see, e.g., Wooldridge (2005)).\nEmpirical example: Estimating the effect of smoking during pregnancy on infant birth weight (Arellano and Bonhomme (2012)).\nStructural models with parameter restrictions: Certain parametric restrictions yield linear relationships in coefficients.\nEmpirical example: Firm-level Cobb-Douglas production functions where firm-specific productivity differences induce heterogeneous coefficients (Combes et al. (2012); Sury (2011)).\nLog-linearized models: Nonlinear models may be approximated by linear models around a steady-state.\nEmpirical example: Heckman and Vytlacil (1998) demonstrate how the nonlinear Card (2001) education model simplifies to a heterogeneous linear specification after linearization.\n\n\n\n3.1.3 What Do We Care About?\nKey parameters of interest in heterogeneous linear models include:\n\nIndividual effects: The coefficient vector \\(\\bbeta_i\\) for specific units.\nMoments of the distribution: Mean (\\(\\mathbb{E}[\\bbeta_i]\\)), variance, and higher-order moments.\nDistributional properties: The full distribution of \\(\\bbeta_i\\) or its quantiles, or just the tail behavior of the distribution.\n\nSimilar objects are relevant for the panel model in Equation 3.4.\n\n\n3.1.4 Key Challenges\nModels Equation 3.3 and Equation 3.4 are often too general for direct identification of parameters. Key challenges include:\n\nLimited observations per coefficient vector: Since each unit \\(i\\) (or pair \\((i,t)\\)) provides only indirect information through \\(\\bbeta_i'\\bx_i\\) (or \\(\\bbeta_{it}'\\bx_{it}\\)), individual parameters are not directly observed.\nUnrestricted dependence between coefficients and covariates: Without assumptions on the relationship between \\(\\bbeta_i\\) and \\(\\bx_i\\), identification is difficult.\n\n\n\n3.1.5 Identification Strategies\nTo estimate parameters of interest, common identification strategies include:\n\nRestricting coefficient variation:\n\nIn panel settings, assuming time-invariant coefficients simplifies Equation 3.4 to:\n\\[\ny_{it} = \\bbeta_i'\\bx_{it} + u_{it}.\n\\tag{3.5}\\]\nAlternative approaches assume a finite number of latent groups, each with its own coefficient vector, yielding the grouped structure:\n\\[\ny_{it} = \\bbeta_{g_i, t}'\\bx_{it} + u_{it},\n\\tag{3.6}\\]\nstudied in Bonhomme and Manresa (2015), Bester and Hansen (2016), and Bonhomme, Lamadon, and Manresa (2022).\n\nRestricting dependence between \\(\\bbeta_i\\) and \\(\\bx_i\\):\n\nAssuming independence between \\(\\bbeta_i\\) and \\(\\bx_i\\) enables identification of the full distribution of \\(\\bbeta_i\\) (see Hoderlein, Klemelä, and Mammen (2010) for the cross-sectional case in Equation 3.3).\n\n\nBy leveraging these assumptions, researchers can recover meaningful insights from heterogeneous linear models.",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Intro: Linear Models with Heterogeneous Coefficients</span>"
    ]
  },
  {
    "objectID": "linear-introduction.html#key-model",
    "href": "linear-introduction.html#key-model",
    "title": "3  Intro: Linear Models with Heterogeneous Coefficients",
    "section": "3.2 Key Model",
    "text": "3.2 Key Model\n\n3.2.1 Panel Model with Time-Invariant Coefficients\nIn this block of lectures, we focus on the linear panel model with time-invariant heterogeneous coefficients:\n\\[\ny_{it} = \\bbeta_i'\\bx_{it} + u_{it}.\n\\tag{3.7}\\]\nWe primarily adopt the fixed effects (FE) approach, which avoids imposing assumptions on the distribution of \\(\\bbeta_i\\) or its dependence with \\(\\bx_{it}\\). A key advantage of this approach is its flexibility—it allows for arbitrary dependence between covariates and individual-specific coefficients. This means economic agents can select their covariates \\(\\bx_{it}\\) based on knowledge of their own \\(\\bbeta_i\\), which is a common feature of observational data.\n\n\n3.2.2 A Special Case: The Random Intercept Model\nA widely used special case of the panel model is the random intercept model, which serves as a foundation for handling unobserved heterogeneity in applied work. The one-dimensional version takes the form:\n\\[\ny_{it} = \\alpha_i + \\bbeta'\\bx_{it} + u_{it}.\n\\tag{3.8}\\]\nHere, \\(\\bbeta\\) is a common coefficient vector applied to the covariates, while \\(\\alpha_i\\) represents individual-specific intercepts. Despite being called a “fixed effect,” \\(\\alpha_i\\) is typically treated as a random variable, often leading to confusion. This model dates back to Mundlak (1961) and can be extended to accommodate multiple random intercepts, such as in settings with firm \\(\\times\\) industry \\(\\times\\) time structures.",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Intro: Linear Models with Heterogeneous Coefficients</span>"
    ]
  },
  {
    "objectID": "linear-introduction.html#plan-for-this-block",
    "href": "linear-introduction.html#plan-for-this-block",
    "title": "3  Intro: Linear Models with Heterogeneous Coefficients",
    "section": "3.3 Plan for This Block",
    "text": "3.3 Plan for This Block\nThis block of lectures explores the following key topics:\n\nAssessing Standard Estimators Under Heterogeneity:\n\nWe analyze whether conventional estimators for the random intercept mode Equation 3.8} can consistently estimate average effects in the presence of heterogeneous coefficients.\n\nWe distinguish between static and dynamic cases:\n\nIn static settings, we examine the within estimator (a.k.a. “fixed effects estimator”) and establish conditions under which it consistently estimates \\(\\mathbb{E}[\\bbeta_i]\\).\nIn dynamic settings, we explore instrumental variable (IV) estimators and demonstrate why they fail to be consistent for the average effect under coefficient heterogeneity.\n\n\nIntroducing a Robust Mean Group Estimator:\n\nWe discuss an estimator for \\(\\mathbb{E}[\\bbeta_i]\\) that remains valid without requiring assumptions on the joint distribution of \\(\\bbeta_i\\) and \\(\\bx_i\\). This method is applicable in both static and dynamic contexts.\n\nVariance Estimation in a Fixed Effects Framework:\n\nWe derive an estimator for the variance of \\(\\bbeta_i\\), extending the analysis beyond just average effects.\n\nIdentifying the Full Distribution of \\(\\bbeta_i\\):\n\nWe explore methods for recovering the entire distribution of \\(\\bbeta_i\\) under a fixed effects framework, introducing deconvolution techniques as a key tool.\n\n\n\n\n\n\nArellano, Manuel, and Stéphane Bonhomme. 2012. “Identifying distributional characteristics in random coefficients panel data models.” Review of Economic Studies 79 (3): 987–1020. https://doi.org/10.1093/restud/rdr045.\n\n\nBester, C Alan, and Christian B Hansen. 2016. “Grouped Effects Estimators in Fixed Effects Models.” Journal of Econometrics 190 (1): 197–208. https://doi.org/10.1016/j.jeconom.2012.08.022.\n\n\nBonhomme, Stéphane, Thibaut Lamadon, and Elena Manresa. 2022. “Discretizing Unobserved Heterogeneity.” Econometrica 90 (2): 625–43. https://doi.org/10.3982/ECTA15238.\n\n\nBonhomme, Stéphane, and Elena Manresa. 2015. “Grouped Patterns of Heterogeneity in Panel Data.” Econometrica 83 (3): 1147–84. https://doi.org/10.3982/ecta11319.\n\n\nCard, David. 2001. “Estimating the Return to Schooling: Progress on Some Persistent Econometric Problems.” Econometrica 69 (5): 1127–60. https://doi.org/10.1111/1468-0262.00237.\n\n\nCombes, Pierre Philippe, Gilles Duranton, Laurent Gobillon, Diego Puga, and Sébastien Roux. 2012. “The Productivity Advantages of Large Cities: Distinguishing Agglomeration From Firm Selection.” Econometrica 80 (6): 2543–94. https://doi.org/10.3982/ecta8442.\n\n\nHansen, Bruce. 2022. Econometrics. Princeton University Press.\n\n\nHeckman, James, and Edward Vytlacil. 1998. “Instrumental variables methods for the correlated random coefficient model.” Journal of Human Resources 33 (4): 974–87.\n\n\nHoderlein, Stefan, Jussi Klemelä, and Enno Mammen. 2010. “Analyzing the Random Coefficient Model Nonparametrically.” Econometric Theory 26 (03): 804–37. https://doi.org/10.1017/S0266466609990119.\n\n\nMundlak, Yair. 1961. “Empirical Production Function Free of Management Bias.” Journal of Farm Economics 43 (1): 44. https://doi.org/10.2307/1235460.\n\n\nSury, Tavneet. 2011. “Selection and Comparative Advantage in Technology Adoption.” Econometrica 79 (1): 159–209. https://doi.org/10.3982/ecta7749.\n\n\nWooldridge, Jeffrey M. 2005. “Fixed-effects and related estimators for correlated random-coefficient and treatment-effect panel data models.” The Review of Economics and Statistics 87 (May): 385–90.",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Intro: Linear Models with Heterogeneous Coefficients</span>"
    ]
  },
  {
    "objectID": "linear-within-estimator.html",
    "href": "linear-within-estimator.html",
    "title": "4  Within (Fixed Effects) Estimator and Heterogeneous Coefficients",
    "section": "",
    "text": "4.1 Introduction\nAs noted in the previous section, in this block we will focus our attention on the linear panel data model with unit-specific heterogeneous coefficients (Equation 3.7): \\[\ny_{it} = \\bbeta_i'\\bx_{it} + u_{it}.\n\\tag{4.1}\\]\nOur first key parameter of interest is the average coefficient vector, \\(\\E[\\bbeta_i]\\), which serves as the linear model analog to the average treatment effect.",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Within (Fixed Effects) Estimator and Heterogeneous Coefficients</span>"
    ]
  },
  {
    "objectID": "linear-within-estimator.html#introduction",
    "href": "linear-within-estimator.html#introduction",
    "title": "4  Within (Fixed Effects) Estimator and Heterogeneous Coefficients",
    "section": "",
    "text": "4.1.1 Focus: Workhorse Estimators under Heterogeneity\nCan existing workhorse estimators for linear panel data models — the within (fixed effects) and dynamic IV estimators — meaningfully estimate \\(\\E[\\bbeta_i]\\)? Of course, those methods were developed in the context of the simpler random intercept model Equation 3.8 \\[\ny_{it} = \\alpha_i + \\bbeta'\\bx_{it} + u_{it}.\n\\tag{4.2}\\] However, if they can also handle the more general Equation 4.1, then all the better for us — we do not need to develop any new methods.\nRegrettably, we will see that the “standard” estimators will generally fail in the presence of coefficient heterogeneity, both for static and the dynamic formulations of Equation 4.1.\n\n\n4.1.2 This Section: Static Model and Fixed \\(T\\)\nIn this section, we begin by considering the static case and the associated workhorse estimator — the within (fixed effects) estimator. By “static”, we mean that the model satisfies strict exogeneity in the form\n\\[\n\\E[\\bu_i|\\bX_i]=0.\n\\] Recall that this assumption rules out using lagged values of the outcome \\(y_{it}\\) as covariates, hence the “static” terminology.\nThroughout, we will assume that the number \\(N\\) of cross-sectional units is potentially large, while the number \\(T\\) of data points per unit is fixed. This setup is more reflective of typical micropanels.",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Within (Fixed Effects) Estimator and Heterogeneous Coefficients</span>"
    ]
  },
  {
    "objectID": "linear-within-estimator.html#recall-within-estimator-in-the-random-intercept-model",
    "href": "linear-within-estimator.html#recall-within-estimator-in-the-random-intercept-model",
    "title": "4  Within (Fixed Effects) Estimator and Heterogeneous Coefficients",
    "section": "4.2 Recall: Within Estimator in the Random Intercept Model",
    "text": "4.2 Recall: Within Estimator in the Random Intercept Model\nTo begin, we will briefly go through the construction and the properties of the within estimator under the random intercept model Equation 4.2.\n\n4.2.1 Construction\nWithin (“fixed effects”) estimation of the random intercept model has two steps:\n\nApply the within transformation to each unit.\nApply OLS to the resulting pooled data.\n\n\n4.2.1.1 Step 1: Within Transformation\nTo perform the within transformation, we first average the equations for unit \\(i\\) across \\(t\\). Label the average of \\(y_{it}\\) across \\(t\\) for unit \\(i\\) as\n\\[\ny_{i\\cdot} = \\frac{1}{T} \\sum_{t=1}^{T} y_{it}.\n\\]\nThe averaged outcome \\(y_{i\\cdot}\\) satisfies the averaged equation\n\\[\ny_{i\\cdot} = \\alpha_i + \\bbeta' \\bX_{i\\cdot} + u_{i\\cdot},\n\\] where \\(\\bx_{i\\cdot}\\) and \\(u_{i\\cdot}\\) are defined analogously to \\(y_{i\\cdot}\\).\nWe then subtract this averaged equation from the original equation for each \\(t\\), defining within-transformed variables \\[\n\\tilde{y}_{it} = y_{it} - y_{i\\cdot}.\n\\]\nIf Equation 4.2 is true, the within transformed variables follow the within-transformed equation:\n\\[\n\\tilde{y}_{it} = \\bbeta' \\tilde{\\bX}_{it} + \\tilde{u}_{it}.\n\\tag{4.3}\\]\nUnder Equation 4.2, the within transformation eliminates the individual random intercepts \\(\\alpha_i\\). Equation 4.3 now looks like a regular homogeneous regression.\n\n\n4.2.1.2 Step 2: OLS on the Within-Transformed Equation\nThe within (fixed effects) estimator is obtained by simply pooling the data across \\(i\\) and \\(t\\) in Equation 4.3 and applying OLS to it. Specifically, the estimator is given by\n\\[\n\\hat{\\bbeta}^W = \\left(\\sum_{i=1}^{N} \\tilde{\\bX}_i' \\tilde{\\bX}_i \\right)^{-1} \\sum_{i=1}^{N} \\tilde{\\bX}_i \\tilde{\\mathbf{y}}_i.\n\\tag{4.4}\\]\n\n\n\n4.2.2 Properties\nThe within estimator enjoys several desirable properties under the random intercept model, most of which can be derived from its sampling error representation \\[\n\\hat{\\bbeta}^W = \\bbeta + \\left(\\sum_{i=1}^{N} \\tilde{\\bX}_i' \\tilde{\\bX}_i \\right)^{-1} \\sum_{i=1}^{N} \\tilde{\\bX}_i \\tilde{\\bu}_i.\n\\tag{4.5}\\]\n\n\\(\\hat{\\bbeta}^W\\) is unbiased for \\(\\bbeta\\). To show this property, it is sufficient to notice that strict exogeneity of \\(\\bu_i\\) with respect to \\(\\bX_i\\) implies strict exogeneity of \\(\\tilde{\\bu}_i\\) with respect to \\(\\tilde{\\bX}_i\\): \\[\n\\E[\\tilde{\\bu}_i|\\tilde{\\bX}_i] =\n\\E[\\E[\\tilde{\\bu}_i|\\bX_i]|\\tilde{\\bX}_i] = 0.\n\\] It follows that the mean of the second term in Equation 4.5 is 0, and so \\[\n\\E[\\hat{\\bbeta}^W] = \\bbeta.\n\\]\n\\(\\hat{\\bbeta}^W\\) is consistent for \\(\\bbeta\\) and asymptotically normal, provided a standard rank condition holds for \\(\\tilde{\\bX}_i\\): \\[\n\\hat{\\bbeta}^W \\xrightarrow{p} \\bbeta, \\quad \\sqrt{N}(\\hat{\\bbeta}^W - \\bbeta) \\Rightarrow N(0, \\Sigma).  \n\\tag{4.6}\\]\n\nSince \\(\\bbeta\\) is the average coefficient vector in this homogeneous model, we conclude that the within estimator consistently estimates average coefficients under the random intercept model 4.2.",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Within (Fixed Effects) Estimator and Heterogeneous Coefficients</span>"
    ]
  },
  {
    "objectID": "linear-within-estimator.html#adding-heterogeneous-coefficients",
    "href": "linear-within-estimator.html#adding-heterogeneous-coefficients",
    "title": "4  Within (Fixed Effects) Estimator and Heterogeneous Coefficients",
    "section": "4.3 Adding Heterogeneous Coefficients",
    "text": "4.3 Adding Heterogeneous Coefficients\nHowever, there is usually no theoretical reason for the slopes \\(\\bbeta\\) to be homogeneous. This assumption goes against acknowledging heterogeneity and including the random intercept terms \\(\\alpha_i\\) in the first place It is rather more realistic to consider the more general Equation 4.1. Accordingly, we now turn to studying the properties of \\(\\hat{\\bbeta}^W\\) in this more realistic setting.\n\n\n4.3.1 Sampling Error Form\nApplying the within transformation to the heterogeneous Equation 4.1 yields another version of the within-transformed equation:\n\\[\n\\tilde{y}_{it} = \\bbeta_i' \\tilde{\\bX}_{it} + \\tilde{u}_{it}.\n\\]\nNote that now the individual heterogeneity is not eliminated! The heterogeneous coefficients \\(\\bbeta_i\\) remain in the equation.\nThe within estimator on the above equation may then be represented as follows: \\[\n\\begin{aligned}\n\\hat{\\bbeta}^W  & = \\left(\\sum_{i=1}^N \\tilde{\\bX}_i'\\tilde{\\bX}_i \\right)^{-1} \\sum_{i=1}^N \\tilde{\\bX}_i \\tilde{\\by}_i \\\\\n& = \\left(\\sum_{i=1}^N \\tilde{\\bX}_i'\\tilde{\\bX}_i \\right)^{-1} \\sum_{i=1}^N \\tilde{\\bX}_i \\tilde{\\bX}_i\\bbeta_i + \\left(\\sum_{i=1}^N \\tilde{\\bX}_i'\\tilde{\\bX}_i \\right)^{-1} \\sum_{i=1}^N \\tilde{\\bX}_i \\tilde{\\bu}_i.\n\\end{aligned}\n\\] Note the difference of the sampling error representation with Equation 4.5. The first term is now a weighted average of the individual coefficients. The weights themselves depend on the second moments of the within-transformed explanatory variables, which may be viewed as a kind of variance weighting for units.\nDoes the within estimator target \\(\\E[\\bbeta_i]\\)? To proceed, we decompose \\(\\bbeta_i\\) into a common mean component \\(\\E[\\bbeta_i]\\) and an idiosyncratic deviation \\(\\bEta_i\\): \\[\n\\bbeta_i = \\E[\\bbeta_i] + \\bEta_i\n\\]\nWith this representation, we can further analyze the within estimator as \\[\n\\begin{aligned}\n    \\hat{\\bbeta} & = \\E[\\bbeta_i]  + \\left( \\dfrac{1}{N}\\sum_{i=1}^N \\tilde{\\bX}_i'\\tilde{\\bX}_i \\right)^{-1}  \\dfrac{1}{N}\\sum_{i=1}^N \\tilde{\\bX}_i \\tilde{\\bX}_i\\bEta_i \\\\\n    &  \\phantom{ = \\E[\\bbeta_i] } + \\left( \\dfrac{1}{N}\\sum_{i=1}^N  \\tilde{\\bX}_i'\\tilde{\\bX}_i \\right)^{-1} \\dfrac{1}{N}\\sum_{i=1}^N \\tilde{\\bX}_i \\tilde{\\bu}_i\\\\\n    & \\xrightarrow{p} \\E[\\bbeta_i]  + \\left(\\E\\left[\\tilde{\\bX}_i'\\tilde{\\bX}_i \\right] \\right)^{-1} \\E\\left[\\tilde{\\bX}_i'\\tilde{\\bX}_i\\bEta_i \\right]  \\\\\n  &    \\phantom{ = \\E[\\bbeta_i] }  + \\left(\\E\\left[\\tilde{\\bX}_i'\\tilde{\\bX}_i \\right] \\right)^{-1} \\E\\left[\\tilde{\\bX}_i'\\tilde{\\bu}_i \\right]\\\\\n    & = \\E[\\bbeta_i] + \\left(\\E\\left[\\tilde{\\bX}_i'\\tilde{\\bX}_i \\right] \\right)^{-1} \\E\\left[\\tilde{\\bX}_i'\\tilde{\\bX}_i\\bEta_i \\right],\n\\end{aligned}\n\\] where we have assumed that a suitable law of large numbers applies as \\(N\\to\\infty\\) and \\(T\\) is fixed, and where \\(\\E\\left[\\tilde{\\bX}_i'\\tilde{\\bu}_i \\right]=0\\) as above.\n\n\n4.3.2 Conditions for Estimating Average Coefficients\nThe above representation shows that the within estimator is not estimating \\(\\E[\\bbeta_i]\\) unless the following orthogonality condition holds: \\[\n    \\E\\left[\\tilde{\\bX}_i'\\tilde{\\bX}_i\\bEta_i \\right] =0.\n\\tag{4.7}\\] Even though \\(\\E[\\bEta_i]=0\\), the above condition does not necessarily hold if \\(\\bbeta_i\\) and \\(\\bX_i\\) are allowed to dependent.\nIf condition 4.7 holds, the within estimator is consistent for \\(\\E[\\bbeta_i]\\) in the heterogeneous coefficient model Equation 4.1. If it fails, the estimator is subject to heterogeneity bias (Campello, Galvao, and Juhl 2019).\nThis orthogonality condition 4.7 is a bit complicated to understand. A simpler sufficient condition is a mean independence on the coefficients given the within transformed covariates: \\[\nE[\\boldsymbol{\\eta}_i|\\tilde{\\bX}_i] = 0.  \n\\tag{4.8}\\] Under this condition \\(\\E[\\tilde{\\bX}_i'\\tilde{\\bX}_i\\bEta_i] =0\\), and thus the within estimator is consistent for \\(\\E[\\bbeta_i]\\). These conditions were proposed by Wooldridge (2003), Wooldridge (2005) (see all Murtazashvili and Wooldridge (2008) for the IV within estimator case).\nNote that this conditions restricts the dependence structure between \\(\\bbeta_i\\) and \\(\\bx_{it}\\). Such conditions are called (CRE) restrictions. CRE assumptions lie between fixed effects (FE) frameworks — which do not restrict the dependence — and random effects (RE) — which assume that unobserved components are independent from the observed ones.\n\n\n4.3.3 Intuition\nHow can we interpret condition 4.8? Intuitively, it requires that the changes in \\(\\bx_{it}\\) over time are uncorrelated with the individual coefficients.\nTo see this interpretation, it is helpful to think of the following example framework. Suppose that \\(\\bx_{it}\\) is stationary, that is, its distribution does not depend on \\(t\\). Decompose \\(\\bx_{it}\\) as \\[\n\\bx_{it} = \\E[\\bx_{it}|\\bbeta_i]  + \\bxi_{it},\n\\]\nThen the within transformed variables satisfy: \\[\n    \\tilde{\\bx}_{it} = \\tilde{\\bxi}_{it}.\n\\]\nThe ``systemic’’ component \\(\\E[\\bx_{it}|\\bbeta_i]\\) is not present in \\(\\tilde{\\bx}_{it}\\). Only the deviations across time \\(\\tilde{\\bxi}_{it}\\) are left. Condition 4.8 requires that \\(\\tilde{\\bxi}_{it}\\) and \\(\\bEta_i\\) are unrelated on average. Note that it permits an arbitrary relationship between \\(\\bbeta_i\\) and \\(\\E[\\bx_{it}|\\bbeta_i]\\).\nAn intuitive version of the above framework goes as follows. A consumer knows their marginal utilities \\(\\bbeta_i\\) of consuming more of a variety of products. With this knowledge, they choose the optimal desired level of consumption — \\(\\E[\\bx_{it}|\\bbeta_i]\\). When they attempt to realize this consumption, they may encounter some frictions \\(\\bxi_{it}\\) which cause them to deviate from \\(\\E[\\bx_{it}|\\bbeta_i]\\). If these ``frictions’’ are uncorrelated with \\(\\bbeta_i\\), then the required consistency will hold.\n\n\n4.3.4 Why Panel Data is Useful\nIt is useful to contrast condition 4.8 with the stronger condition \\[\n\\E[\\bEta_i|\\bX_i]=0.\n\\] Note the difference in the conditioning sets.\nThe latter condition is stronger in the view of the tower property of conditional expectation. Intuitively, we can compute \\(\\tilde{\\bX}_i\\) from \\(\\bX_i\\), but not vice versa. The requirement that \\(\\E[\\bEta_i|\\bX_i]=0\\) may be very strong, since it would in general require that \\(\\E[\\bx_{it}|\\bbeta_i]\\) does not depend on \\(\\bbeta_i\\) — we rule out a systemic dependence even on average.\nThis contrast also highlights the advantages of panel data. In a cross-sectional setting, OLS would require a condition of the form \\(\\E[\\bEta_i|\\bX_i]=0\\) or \\(\\E[\\bx_i\\bx_i'\\bbeta_i]=0\\) for consistency. With panel data, weaker conditions are sufficient, and systemic dependence between \\(\\bbeta_i\\) and \\(\\bx_{it}\\) is possible. Moreover, as you might have noticed, the above analysis can already be carried out with \\(T=2\\).\n\n\n4.3.5 Example\nWe conclude this section with a small illustration of the results in a tractable model (see this blog post for a simulation with some dramatic examples). Specifically, we consider the following panel model with two periods, coefficient heterogeneity, and a scalar regressor: \\[\ny_{it} = \\alpha_i + \\beta_i x_{it} + u_{it}, \\quad t=1,2.\n\\]\nwhere \\(\\bX_{it}\\) and \\(\\bbeta_i\\) are jointly normal:\n\\[\n\\begin{aligned}\n    \\begin{pmatrix}\n      x_{i1}\\\\\n      x_{i2}\\\\\n      \\beta_i\n    \\end{pmatrix} \\sim N\\left(  \\begin{pmatrix}\n    1\\\\\n    2\\\\\n    0.5\n    \\end{pmatrix}, \\begin{pmatrix}\n    1 & \\rho_{1, \\beta}\\rho_{2, \\beta} & \\rho_{1, \\beta}\\\\\n    \\rho_{1, \\beta}\\rho_{2, \\beta} & 1 & \\rho_{2, \\beta}\\\\\n    \\rho_{1, \\beta} & \\rho_{2, \\beta} & 1\n    \\end{pmatrix}   \\right),\n\\end{aligned}\n\\tag{4.9}\\] where the various \\(\\rho\\) parameters are correlations. The correlation between \\(x_{i1}\\) and \\(x_{i2}\\) is such that they are only correlated through \\(\\beta_i\\). The distribution of the \\(\\alpha_i\\) does not have to be specified, as it is not involved in the consistency conditions. Likewise, we only need to assume that \\(\\E[u_{it}|x_{i1}, x_{i2}]=0\\) without further specifying the distribution of \\(u_{it}\\).\nThe within transformations yields the following equation: \\[\n                y_{i2} - y_{i1} = \\beta_i(x_{i2}-x_{i1}) + (u_{i2}-u_{i1})\n\\] The mean independence condition 4.8 takes form \\[\n    \\E[ \\beta_i|x_{i2} - x_{i1}]  = 0.5.\n\\]\nIt is not difficult to work out (Brockwell and Davis 2016, A.3.1) that \\[\n\\E[ \\beta_i|x_{i2} - x_{i1}]  = 0.5 + (\\rho_{2, \\beta}- \\rho_{1, \\beta})(x_{i2} - x_{i1} - 1)\n\\] Thus, \\(\\E[ \\beta_i|x_{i2} - x_{i1}]=0.5\\) only holds if \\[\n\\rho_{2, \\beta} = \\rho_{1, \\beta}.\n\\tag{4.10}\\] In this case, \\(x_{it}\\) becomes stationary, and does not have dynamics that depend on \\(\\beta_i\\) in the mean.\nIf condition 4.10 holds, the within estimator is consistent. It is also possible to show that if condition 4.10 fails, so does the more general Equation 4.7, and the within estimator is inconsistent. We represent this fact on Figure 4.1, where we fix \\(\\rho_{1, beta}=0.25\\), and vary \\(\\rho_{2, \\beta}\\) between \\(-1\\) and \\(1\\). Observe that the within estimator is consistent if \\(\\rho_{2, \\beta} = \\rho_{1, \\beta} = 0.25\\). Otherwise, it is biased, potentially severely. For \\(\\rho_{2, \\beta}\\leq -0.6\\), the estimand of the within estimator has a sign different from that of \\(\\E[\\beta_i]\\).\n\n\n\n\n\n\nFigure 4.1: The within estimator under coefficient heterogeneity. Consistency and inconsistency for the average coefficient under data generating process 4.9\n\n\n\n\n\n\n\nBrockwell, Peter J., and Richard A. Davis. 2016. Introduction to Time Series and Forecasting. Springer Texts in Statistics. Springer International Publishing.\n\n\nCampello, Murillo, Antonio F. Galvao, and Ted Juhl. 2019. “Testing for Slope Heterogeneity Bias in Panel Data Models.” Journal of Business and Economic Statistics 37 (4): 749–60. https://doi.org/10.1080/07350015.2017.1421545.\n\n\nMurtazashvili, Irina, and Jeffrey M. Wooldridge. 2008. “Fixed effects instrumental variables estimation in correlated random coefficient panel data models.” Journal of Econometrics 142 (1): 539–52. https://doi.org/10.1016/j.jeconom.2007.09.001.\n\n\nWooldridge, Jeffrey M. 2003. “Fixed Effects Estimation of the Population-Averaged Slopes in a Panel Data Random Coefficient Model.” Econometric Theory 19: 411–13. https://doi.org/10+10170S0266466603002081.\n\n\n———. 2005. “Fixed-effects and related estimators for correlated random-coefficient and treatment-effect panel data models.” The Review of Economics and Statistics 87 (May): 385–90.",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Within (Fixed Effects) Estimator and Heterogeneous Coefficients</span>"
    ]
  },
  {
    "objectID": "linear-dynamic-panel-iv.html",
    "href": "linear-dynamic-panel-iv.html",
    "title": "5  Interlude: Standard Dynamic Panel Estimators",
    "section": "",
    "text": "5.1 Exogeneity and Dynamic Models",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Interlude: Standard Dynamic Panel Estimators</span>"
    ]
  },
  {
    "objectID": "linear-dynamic-panel-iv.html#exogeneity-and-dynamic-models",
    "href": "linear-dynamic-panel-iv.html#exogeneity-and-dynamic-models",
    "title": "5  Interlude: Standard Dynamic Panel Estimators",
    "section": "",
    "text": "5.1.1 Introduction\nThroughout the previous section, we assumed that the idiosyncratic term \\(u_{it}\\) satisfied strict exogeneity with respect to the data: \\[\n    \\E[u_{it}|\\bX_i] = 0.\n\\tag{5.1}\\]\nHowever, strict exogeneity is not an innocent assumption. In particular, it implies that for all pairs of indices \\(t, s\\) it holds that \\[\n    \\E[u_{it}\\bx_{is}] =0.\n\\tag{5.2}\\]\nIf we take \\(t&lt;s\\), Equation 5.2 means that past shocks are uncorrelated with future values of \\(\\bx\\) or, intuitively, that one cannot predict past shocks from future \\(\\bx\\)s.\nThis requirement might fail if \\(\\bx\\) is dynamic and its evolution is affected by \\(u_{it}\\). In this section, we will discuss this challenge and some traditional approaches to dealing with it with short panel data.\n\n\n5.1.2 No Strict Exogeneity for Dynamic Models\nA particularly clear example for failure of Equation 5.2 arises when \\(\\bx_{it}\\) includes lagged values of the outcome. As we show now, strict exogeneity cannot hold in this case.\nFor simplicity, we momentarily forget about the cross-sectional dimension consider a simple autoregressive model with 1 lag (AR(1)): \\[\n    y_t = \\alpha + \\lambda y_{t-1} + u_{t},\n\\] where \\(t=1, \\dots, T\\) and the innovation \\(u_t\\) satisfies \\(\\E[u_t]=0\\).\nTo show that strict exogeneity fails, it is sufficient to find a single pair of \\((t, s)\\) such that Equation 5.2 is not true. Specifically, we will take \\(s=t+1\\) and show that \\(\\E[y_{it+1}u_t]\\) is not necessarily zero.\nTo evaluate this expectation, we write the model at \\(t+1\\) \\[\n    y_{t+1} = \\alpha + \\lambda y_t + u_{t+1}.\n\\tag{5.3}\\] We then substitute the model into \\(\\E[y_{it+1}u_t]\\) \\[\n\\begin{aligned}\n    \\E[y_{t+1}u_t] & = \\lambda\\E[y_t u_t] + \\E[u_{t+1}u_t] \\\\\n    &  = \\lambda^2\\E[y_{t-1}u_t] + \\lambda\\E[u_t^2] + \\E[u_{t+1}u_t] .\n\\end{aligned}\n\\]\nWhat can we say about the right hand side? In many contexts, we may reasonably assume that\n\nOne cannot predict the shocks of tomorrow from what you have today, so that \\[\\E[y_{t-1}u_t]=0.\\]\n\\(u_{t}\\) is uncorrelated over time, so that \\[\\E[u_{t+1}u_t]=0.\\]\n\nHowever, \\(\\lambda\\E[u_t^2]\\) is zero only in two unreasonable cases:\n\nIf \\(\\lambda=0\\), and so the model is not actually dynamic\n\\(\\E[u_t^2]=0\\), and so the process is actually fully deterministic.\n\nBoth of these options are unpleasant. The first one goes against the idea of allowing any dynamics. The second is extremely unlikely with any kind of social data. We conclude that in dynamic models it is the case \\[\n\\E[y_{it+1}u_t] \\neq 0.\n\\tag{5.4}\\] A fortiori, strict exogeneity also cannot hold in dynamic models.\n\n\n5.1.3 Sequential Exogeneity\nSo what can you do if you want to allow for dynamic models? Since strict exogeneity (5.2) is effectively impossible to satisfy, we need a weaker form of exogeneity.\nOne popular weaker assumption compatible with dynamic models is sequential exogeneity (or predeterminedness). In context of the simple univariate time series model (5.3), sequential exogeneity may be stated as \\[\n        \\E[u_{t}| y_{t-1}, y_{t-2}, \\dots] =0.\n\\] Intuitively, sequential exogeneity states that future shocks cannot be predicted using past covariates. However, it does not restrict our ability to predict the past from the future — the context which created problems for strict exogeneity.\nMore generally, consider a panel data linear model with homogeneous coefficients, a random intercept, and a dynamic process for the outcome: \\[\ny_{it} = \\alpha_i + \\sum_{k=1}^K \\lambda_k y_{it-k} + \\bbeta'\\bx_{it} + u_{it}.  \n\\tag{5.5}\\] In this model, a sequential exogeneity assumption takes form \\[\n     \\E[u_{it}|\\curl{y_{is-1}, \\bx_{is}}_{s\\leq t}] =0.\n\\] Model (5.5) is a dynamic counterpart of the static model (4.2) we discussed in the last section.",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Interlude: Standard Dynamic Panel Estimators</span>"
    ]
  },
  {
    "objectID": "linear-dynamic-panel-iv.html#handling-dynamic-panels-with-a-random-intercept",
    "href": "linear-dynamic-panel-iv.html#handling-dynamic-panels-with-a-random-intercept",
    "title": "5  Interlude: Standard Dynamic Panel Estimators",
    "section": "5.2 Handling Dynamic Panels with a Random Intercept",
    "text": "5.2 Handling Dynamic Panels with a Random Intercept\nBefore moving on and introducing heterogeneous coefficients in dynamic linear models, we will discuss model (5.5) in more detail. In particular, we will develop the standard workhorse instrumental variable estimators. We will analyze how these estimators fare in the more general model (3.7) in the next section.\n\n5.2.1 Model\nFor the sake of simplicity, we will discuss a simple version of model (5.5) without extra covariates \\(\\bx_{it}\\) and with only one lag of \\(y_{it}\\): \\[\ny_{it} = \\alpha_i + \\lambda y_{it-1} + u_{it},\n\\tag{5.6}\\] where \\(u_{it}\\) satisfies sequential exogeneity in the form \\(\\E[u_{it}|y_{is}, s&lt;t] = 0\\). This random intercept dynamic model has extensively considered in the literature (e.g. Anderson and Hsiao 1982; Arellano and Bond 1991; Blundell and Bond 1998).\nThe key parameter of interest is \\(\\lambda\\). By homogeneity of \\(\\lambda\\), it also plays the role of the average coefficient for model (5.6).\nHere, we will primarily focus on the large-\\(N\\), fixed-\\(T\\) case, though model (5.5) has also been extensively studied in the large-(\\(N, T\\)) case (e.g. Alvarez and Arellano 2003).\n\n\n5.2.2 Endogeneity\nTo work towards an estimator for \\(\\lambda\\), let us difference Equation 5.5 across \\(t\\) to eliminate the random intercept \\(\\alpha_i\\). The differenced equation takes form \\[\n\\begin{aligned}\n\\Delta y_{it} & = \\lambda \\Delta y_{it-1} + \\Delta u_{it}, \\\\\n\\Delta y_{it} & = y_{it} - y_{it-1}.\n\\end{aligned}\n\\tag{5.7}\\] Equation 5.7 seems like a simple regression equation. It is tempting to just apply OLS and regress \\(\\Delta y_{it}\\) on \\(\\Delta y_{it-1}\\).\nIt turns out that this approach will fail as there is an endogeneity problem in Equation 5.7! Sequential exogeneity is not enough to guarantee that \\[\n\\E[\\Delta y_{it-1}\\Delta u_{it}] = 0.\n\\]\nTo see why, we expand \\(\\E[\\Delta y_{it-1}\\Delta u_{it}]\\) as\n\\[\n\\begin{aligned}\n    & \\E\\left[(u_{it}-u_{it-1})(y_{it-1}-y_{it-2}) \\right] \\\\\n    & = \\E[ u_{it}y_{it-1} ] + \\E[(u_{it-1}-u_{it})y_{it-2}] - \\E[u_{it-1}y_{it-1}]  \\\\\n    & = -\\E[u_{it-1} y_{it-1}].\n\\end{aligned}\n\\] Sequential exogeneity is sufficient to immediately eliminate the first 2 expectations. For the last expectation remaining, we can substitute \\(y_{it-1}\\) to see that \\[\n\\begin{aligned}\n    \\E[u_{it-1}y_{it-1}] & = \\lambda\\E[u_{it-1}y_{it-2}] + \\E[u_{it-1}^2]\\\\\n    & = \\E[u_{it-1}^2]\n\\end{aligned}\n\\] As noted above, in general we expect that \\(\\E[u_{it-1}^2] \\neq 0\\). Hence we conclude that \\[\n    \\E[\\Delta y_{it-1}\\Delta u_{it}]\\neq 0.\n\\tag{5.8}\\] In other words, \\(\\Delta y_{it-1}\\) is an endogenous regressor in the differenced Equation 5.7.\n\n\n\n\n\n\nOne should not confuse endogeneity in Equation 5.8 with the failure of strict but not necessarily sequential exogeneity in dynamic models (e.g. Equation 5.4).",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Interlude: Standard Dynamic Panel Estimators</span>"
    ]
  },
  {
    "objectID": "linear-dynamic-panel-iv.html#iv-estimation-of-dynamic-panel-models",
    "href": "linear-dynamic-panel-iv.html#iv-estimation-of-dynamic-panel-models",
    "title": "5  Interlude: Standard Dynamic Panel Estimators",
    "section": "5.3 IV Estimation of Dynamic Panel Models",
    "text": "5.3 IV Estimation of Dynamic Panel Models\nThe traditional solution to endogeneity is to use instrumental variables: variables \\(z_{it}\\) which satisfy relevance and exogeneity conditions: \\[\n\\begin{aligned}\n    \\E[z_{it}\\Delta y_{it-1}] \\neq 0,\\\\\n    \\E[z_{it}\\Delta u_{it}] = 0.\n\\end{aligned}\n\\]\nIn most contexts, one has to look for external variables that can serve as instruments.\nHowever, Equation 5.7 is a very special case where one can use instruments internal to the model!\n\n5.3.1 The Anderson-Hsiao Estimator\nIn particular, consider using \\(y_{it-2}\\) as an instrument.\n\nRelevance seems to be relatively straightforward, as the target endogenous variable \\(\\Delta y_{it-1}= y_{it-1}-y_{it-2}\\) actually has the instrument inside.\nExogeneity can be justified by appealing to sequential exogeneity: \\[ \\E[y_{it-2}\\Delta u_{it}]  = \\E[y_{it-2}u_{it} - y_{it-2}u_{it-1}]=0. \\]\nHence \\(y_{it-2}\\) is a valid instrument!\n\nThe resulting IV estimator is known as the Anderson and Hsiao (1982) estimator and given by \\[\n\\hat{\\lambda}^{AH} = \\dfrac{ \\sum_{t=2}^T y_{it-2}\\Delta y_{it} }{\\sum_{t=2}^T y_{it-2}\\Delta y_{it} }.\n\\]\n\n\n5.3.2 Further Dynamic Panel IV Estimators\nAre there more instruments that can use for \\(\\Delta y_{it-1}\\)? Using more instruments will induce overidentification and potentially lead to more precise estimators, solving one of the key drawbacks of the Anderson and Hsiao (1982) estimator (Arellano 1989).\nAs a partial answer, suppose we consider \\(y_{it-k}\\) for \\(k\\geq 2\\). By applying sequential exogeneity again we can show that \\(y_{it-k}\\) is exogenous: \\[  \n\\E[y_{it-k}\\Delta u_{it}]  = \\E[y_{it-k}u_{it} - y_{it-k}u_{it-1}]=0.\n\\] Provided \\(y_{it-k}\\) is correlated with \\(\\Delta y_{it-1}\\) and available in the data, it also becomes a valid instrument. Following this chain of reasoning and using all available lags \\(y_{it-k}\\) yields the Arellano and Bond (1991) estimator.\nEven further instruments have been found for Equation 5.7 by Ahn and Schmidt (1995) and Blundell and Bond (1998), among others.\nAll of these estimators are implemented in\n\nR: plm.\nPython: pydynpd.\n\n\n\n5.3.3 Properties of Dynamic Panel IV Estimators\nUnder some standard conditions, the above instrumental variable estimators will all be consistent and asymptotically normal for \\(\\lambda\\) as \\(N\\to\\infty\\) and \\(T\\) is fixed. The matter is rather more delicate if both \\(N\\) and \\(T\\) are large, and the above dynamic panel IV estimators offer an interesting and natural example of the many moments bias. See Alvarez and Arellano (2003).",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Interlude: Standard Dynamic Panel Estimators</span>"
    ]
  },
  {
    "objectID": "linear-dynamic-panel-iv.html#extra-endogeneity-and-the-within-estimator",
    "href": "linear-dynamic-panel-iv.html#extra-endogeneity-and-the-within-estimator",
    "title": "5  Interlude: Standard Dynamic Panel Estimators",
    "section": "5.4 Extra: Endogeneity and the Within Estimator",
    "text": "5.4 Extra: Endogeneity and the Within Estimator\nOne may think that we had the endogeneity problem (5.8) because we took first differences instead of applying the within transformation.\nHowever, the same issue endogeneity issue affects the within estimator. First, for \\(T=2\\) the above discussion applies directly, as the within transformation is numerically identical to first differencing. Second, more generally, the within estimator will suffer from its own version of endogeneity. To see the issue, note that the within-transformed model (5.6) can be written as (see Equation 4.3): \\[\n    \\tilde{y}_{it} = \\lambda \\tilde{y}_{it-1} + \\tilde{u}_{it}.\n\\]\nOne can now immediately see that \\(\\tilde{y}_{it-1}\\) will also be an endogenous regressor as\n\\[\n    \\E[\\tilde{y}_{it-1}\\tilde{u}_{it}] = \\E\\left[\\left(y_{it-1}- T^{-1}\\sum_{s=0}^{T-1} y_{is} \\right)\\left(u_{it} - T^{-1}\\sum_{r=1}^{T}u_{ir} \\right) \\right].\n\\]\nThe expectation on the right hand side contains “bad” expectations of the form \\(\\E[u_{it}y_{is}]\\) with \\(t&lt;s\\) (recall Equation 5.4).\nWe conclude that for any fixed \\(T\\) the within estimator will also suffer from endogeneity bias; as derived by Nickell (1981). Furthermore, this bias is likely to be large in pratice (see Kiviet 1995).\n\n\n\n\nAhn, Seung Chan, and Peter Schmidt. 1995. “Efficient Estimation of Models for Dynamic Panel Data.” Journal of Econometrics 68 (1): 5–27. https://doi.org/10.1016/0304-4076(94)01641-C.\n\n\nAlvarez, Javier, and Manuel Arellano. 2003. “The Time Series and Cross-Section Asymptotics of Dynamic Panel Data Estimators.” Econometrica 71 (4): 1121–59.\n\n\nAnderson, T. W., and Cheng Hsiao. 1982. “Formulation and estimation of dynamic models using panel data.” Journal of Econometrics 18 (1): 47–82. https://doi.org/10.1016/0304-4076(82)90095-1.\n\n\nArellano, Manuel. 1989. “A note on the Anderson-Hsiao estimator for panel data.” Economics Letters 31 (4): 337–41. https://doi.org/10.1016/0165-1765(89)90025-6.\n\n\nArellano, Manuel, and Stephen Bond. 1991. “Some Tests of Specification for Panel Carlo Application to Data: Monte Carlo Evidence and an Application to Employment Equations.” Review of Economic Studies 58: 277–97.\n\n\nBlundell, Richard, and Stephen Bond. 1998. “Initial Conditions and Moment Restrictions in Dynamic Panel Data Models.” Journal of Econometrics 87: 115–43.\n\n\nKiviet, Jan F. 1995. “On Bias, Inconsistency, and Efficiency of Various Estimators in Dynamic Panel Data Models.” Journal of Econometrics 68 (1): 53–78. https://doi.org/10.1016/0304-4076(94)01643-E.\n\n\nNickell, Stephen. 1981. “Biases In Dynamic Models With Fixed Effects.” Econometrica 49 (6): 1417–26.",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Interlude: Standard Dynamic Panel Estimators</span>"
    ]
  },
  {
    "objectID": "linear-dynamic-panel-heterogeneity.html",
    "href": "linear-dynamic-panel-heterogeneity.html",
    "title": "6  Heterogeneous Coefficient Dynamic Panels and Instrumental Variable Estimators",
    "section": "",
    "text": "6.1 Introduction and Model\nAs in the static case, it is not clear why the slopes should be homogenous in dynamic models. If the coefficients are the same between units, all units have the same dynamics. Such an assumption seems rather unrealistic in most scenarios.\nAs a consequence, we now consider heterogeneous dynamic models. In this section we will again focus on a simple AR(1) model with no exogenous regressors. Specifically, we will look at the following heterogeneous version of model (5.6): \\[\n\\begin{aligned}\n    y_{it}   & = \\alpha_i +  \\lambda_iy_{it-1} + u_{it}, \\\\\n0 & = \\E[u_{it}| \\curl{y_{is}}_{s\\leq t}] .\n\\end{aligned}\n\\tag{6.1}\\] This model allows for unit-specific dynamics, as the coefficients \\(\\lambda_i\\) can vary across \\(i\\). The above model is also another instance of the general Equation 3.7.\nAs before, we are interested in the average coefficient \\(\\E[\\lambda_i]\\).",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Heterogeneous Coefficient Dynamic Panels and Instrumental Variable Estimators</span>"
    ]
  },
  {
    "objectID": "linear-dynamic-panel-heterogeneity.html#endogeneity-due-to-heterogeneity",
    "href": "linear-dynamic-panel-heterogeneity.html#endogeneity-due-to-heterogeneity",
    "title": "6  Heterogeneous Coefficient Dynamic Panels and Instrumental Variable Estimators",
    "section": "6.2 Endogeneity due to Heterogeneity",
    "text": "6.2 Endogeneity due to Heterogeneity\nCan the IV estimators of the previous section estimate \\(\\E[\\lambda_i]\\) under model (6.1)? Under what conditions? To answer these questions, recall that the IV estimators of the previous section are based on taking first differences in the model and then using lagged values of \\(y_{it}\\) as instruments.\n\n6.2.1 Endogeneity in Differenced Heterogeneous Equation\nTo replicate the procedure, we take differences in Equation 6.1 and write the differenced model as \\[\n\\begin{aligned}\n    \\Delta y_{it} & = \\lambda \\Delta y_{it-1} +  v_{it}, \\\\\n    v_{it} & = \\eta_i\\Delta y_{it-1} + \\Delta u_{it} =0,\n\\end{aligned}\n\\tag{6.2}\\] where we label \\[\n\\begin{aligned}\n\\lambda & = \\E[\\lambda_i], \\\\\n\\eta_i & = \\lambda_i - \\lambda.\n\\end{aligned}\n\\]\nIt is easy to check that \\(\\Delta y_{it-1}\\) is still exogenous due to the presence of \\(u_{it-1}\\) in the residual. The same problematic term \\(\\lambda \\E[u_{it-1}^2]\\) will be present in \\(\\E[v_{it}\\Delta y_{it-1}]\\).\n\n\n6.2.2 Conditions for Instruments\nCan we find a suitable instrument for \\(\\Delta y_{it-1}\\)? Any valid instrument must satisfy relevance and exogeneity, which now take the following form: \\[\n\\begin{aligned}\n    \\E[z_{it}\\Delta y_{it-1}] &  \\neq 0 ,\\\\\n    \\E[z_{it} v_{it}] & = \\E[ \\eta_i z_{it}\\Delta y_{it-1} ] + \\E[z_{it}u_{it}].\n\\end{aligned}\n\\] Note that a new \\(\\E[ \\eta_i z_{it}\\Delta y_{it-1} ]\\) term now appears in the exogeneity condition.\n\n\n6.2.3 Endogeneity of Lagged Outcomes\nIn contrast to the homogeneous case, \\(y_{it-2}\\) will not a valid instrument anymore. We will show that \\(y_{it-2}\\) is not exogenous in a simple case with the following assumptions:\n\n\\(\\abs{\\lambda_i}&lt;1\\).\nEquation 6.1 can be extended infinitely far into the past by recursive substitution, so that \\[\ny_{it} = \\dfrac{\\alpha_i}{1-\\lambda_i} + \\sum_{k=0}^{\\infty} \\lambda_i^k u_{it-k}.\n\\]\n\\(\\curl{u_{it}}_t\\) is an IID sequence with finite second moments, and \\(u_{it}\\) is independent of \\((\\alpha_i, \\lambda_i)\\).\n\nUnder the above assumptions the first expectation in \\(\\E[y_{it-2} v_{it}]\\) can be evaluated as follows: \\[\n\\begin{aligned}\n& \\E[ \\eta_i y_{it-2}\\Delta y_{it-1} ]\n\\\\\n% & = \\E\\left[ \\eta_i\\left( \\left(\\sum_{k=0}^{\\infty} \\lambda_i^k u_{i,t-k-1}\\right)\\left(\\sum_{k=0}^{\\infty} \\lambda_i^k u_{i,t-k-2}\\right) - \\left(\\sum_{k=0}^{\\infty} \\lambda_i^k u_{i,t-k-2}\\right)^2 \\right) \\right] \\\\\n& = \\E\\left[ \\eta_i\\left( \\left(\\sum_{k=0}^{\\infty} \\lambda_i^{1+2k} u_{i,t-k-2}^2 \\right)  -  \\left(\\sum_{k=0}^{\\infty} \\lambda_i^{2k} u^2_{i,t-k-2}\\right)  \\right)\\right] \\\\\n& = \\E[u_{it}^2] \\E\\left[\\eta_i (1-\\lambda_i) \\sum_{k=0}^{\\infty} \\lambda_i^{2k}   \\right].\n\\end{aligned}\n\\] In general, there is no reason to expect the above expectation to be zero if \\(\\eta_i\\) is not zero. The second term involves a sum of even-order moments of \\(\\eta_i\\) (equivalently, \\(\\lambda_i)\\); such a sum would in general be non-zero.\nWe conclude that \\[\n\\E[ \\eta_i y_{it-2}\\Delta y_{it-1} ]\\neq 0,\n\\] and so in general that \\[\n\\E[y_{it-2} v_{it}]\\neq 0.\n\\] In other words, \\(y_{it-2}\\) is not a valid instrument under the heterogeneous model (6.1). The same logic applies under more general assumptions and to higher-order lags of \\(y_{it}\\).\nMore broadly, the problem of finding a valid instrument \\(z_{it}\\) for Equation 6.2 appears intractable. The relevance condition requires that \\(z_{it}\\) be correlated with \\(\\Delta y_{it-1}\\). As a consequence, it is likely that \\(z_{it}\\) will also be correlated with \\(\\eta_i \\Delta y_{it-1}\\) (particularly since \\(\\eta_i\\) appears inside \\(\\Delta y_{it-1}\\)). However, it would then be the case that \\(\\E[ \\eta_i z_{it}\\Delta y_{it-1} ]\\neq 0\\), and exogeneity would fail.\nWe conclude that the IV estimators of the previous section will not consistently estimate \\(\\E[\\lambda_i]\\), no matter how we choose the instruments, regardless the magnitude of \\(T\\). Moreover, the results of Pesaran and Smith (1995) imply that the probability limit of the estimators can be arbitrarily unrelated to the true underlying average coefficients.\n\n\n6.2.4 Aside: Regarding Restrictions on Coefficients\nThere is a further point of contrast with the static case. In section 4 we noted that OLS can consistently estimate the average coefficients in a static model if the coefficients \\(\\bbeta_i\\) are (mean) independent of the regressors. We also derived a weaker condition for the consistency of the within estimator.\nHowever, no such independence assumptions are possible in a dynamic model. By construction, the coefficients \\((\\alpha_i, \\lambda_i)\\) are directly embedded in the process for the regressor \\(y_{it-1}\\) through \\[\ny_{it-1} = \\alpha_i + \\lambda_i y_{it-2} + u_{it-2}.\n\\] It follows that it is mechanically impossible for \\(y_{it-1}\\) and \\((\\alpha_i, \\beta_i)\\) to be (mean) independent.",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Heterogeneous Coefficient Dynamic Panels and Instrumental Variable Estimators</span>"
    ]
  },
  {
    "objectID": "linear-dynamic-panel-heterogeneity.html#a-numerical-illustration",
    "href": "linear-dynamic-panel-heterogeneity.html#a-numerical-illustration",
    "title": "6  Heterogeneous Coefficient Dynamic Panels and Instrumental Variable Estimators",
    "section": "6.3 A Numerical Illustration",
    "text": "6.3 A Numerical Illustration\nHere I will add a numerical example.\n\n\n\n\nPesaran, M. Hashem, and Ron P. Smith. 1995. “Estimating long-run relationships from dynamic heterogeneous panels.” Journal of Econometrics 6061: 473–77.",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Heterogeneous Coefficient Dynamic Panels and Instrumental Variable Estimators</span>"
    ]
  },
  {
    "objectID": "linear-mean-group.html",
    "href": "linear-mean-group.html",
    "title": "7  Mean Group: Robust Estimator for Average Coefficients",
    "section": "",
    "text": "7.1 Mean Group Estimation\nThe results of the previous section and section 4 leave us with key two questions:\nAs it turns out, there is indeed an estimator that is robust both to heterogeneity and dynamics. The mean group (MG) estimator, due to M. H. Pesaran and Smith (1995), permits estimating average coefficients in heterogeneous panels, regardless of the relationship between the coefficients and the covariates. It also does not require strict exogeneity and is compatible with dynamic models. However, this generality comes at a cost: the mean group estimator typically has stricter data requirements compared to non-robust alternatives.",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Mean Group: Robust Estimator for Average Coefficients</span>"
    ]
  },
  {
    "objectID": "linear-mean-group.html#mean-group-estimation",
    "href": "linear-mean-group.html#mean-group-estimation",
    "title": "7  Mean Group: Robust Estimator for Average Coefficients",
    "section": "",
    "text": "In static models, can we estimate the average effect without imposing restrictions on the relationship between \\(\\bx_{it}\\) and \\(\\bbeta_i\\)?\nIn dynamic models, can we estimate \\(\\E[\\lambda_i]\\) at all?\n\n\n\n7.1.1 Model\nTo formally define the mean group estimator, we return to the general Equation 3.7: \\[\n    \\by_{it} = \\bx_{it}'\\bbeta_i + u_{it},\n\\] where we label the dimension of the vectors \\(\\bx_{it}\\) and \\(\\bbeta_i\\) as \\(p\\). We can also express this model in unit-level matrix form by stacking observations across \\(t\\) for each unit \\(i\\): \\[\n\\by_i = \\bX_i\\bbeta_i + \\bu_i,\n\\] where \\(\\bX_i\\) is now a \\(T\\times p\\) matrix of covariates, with \\(T\\) representing the number of observations for each unit.\nIn what follows, we will assume that the regressors \\(\\bx_{it}\\) are orthogonal to the unobserved component \\(u_{it}\\): \\[\n\\E[\\bx_{it}u_{it}] =0.\n\\tag{7.1}\\] This assumption is compatible with both static and dynamic models and is implied by sequential exogeneity.\n\n\n7.1.2 Definition\nFor the mean group estimator to be well-defined, we make two further assumptions:\n\nSufficient unit-level data: each unit must have at least as many observations as regressors, i.e., \\(T\\geq p\\).\nNon-singularity: \\(\\bX_i'\\bX_i\\) has rank maximal rank (\\(p\\)) for all units \\(i\\).\n\nUnder these assumptions, we can compute the OLS estimator of \\(\\bbeta_i\\) for each unit \\(i\\) \\[\n    \\hat{\\bbeta}_i = \\left(\\bX_i'\\bX_i \\right)^{-1}\\bX_i'\\by_i.\n\\tag{7.2}\\]\nThe mean group estimator (M. H. Pesaran and Smith 1995) is defined as the average of unit-level estimators 7.2: \\[\n    \\hat{\\bbeta}_{MG} = \\dfrac{1}{N} \\sum_{i=1}^N \\hat{\\bbeta}_i =  \\dfrac{1}{N} \\sum_{i=1}^N \\left(\\bX_i'\\bX_i \\right)^{-1}\\bX_i'\\by_i.\n\\] In essence, the mean group estimator involves running separate regressions for each unit and averaging the resulting coefficients. The first step requires having enough observations per unit — at least one observation is available for each heterogeneous coefficient.\n\n\n\n\n\n\nWe introduce the MG estimator under the orthogonality condition (7.1). However, it is also possible to introduce an analogous estimator if \\(\\E[\\bx_{it}u_{it}]\\neq 0\\), but instruments for \\(\\bx_{it}\\) are available. In this case, suitable unit-level IV/2SLS estimators replace \\(\\hat{\\bbeta}_i\\) (e.g. Bai, Marcellino, and Kapetanios 2023).\n\n\n\n\n\n7.1.3 Properties\nTo analyze the properties of the \\(\\hat{\\bbeta}_{MG}\\), we can substitute the model for \\(\\by_i\\) into each individual estimator. This substitution yields the sampling error form of the estimator: \\[\n    \\hat{\\bbeta}_{MG}  = \\dfrac{1}{N} \\sum_{i=1}^N \\bbeta_i    + \\dfrac{1}{N} \\sum_{i=1}^N \\left(\\bX_i'\\bX_i \\right)^{-1}\\bX_i'\\bu_i.\n\\]\nAs \\(N\\) grows, the first term will converge to the average effect: \\[\n\\dfrac{1}{N} \\sum_{i=1}^N \\bbeta_i   \\xrightarrow{p} \\E[\\bbeta_i].\n\\] This convergence holds regardless of assumptions on the dependence between \\(\\bbeta_i\\) and \\(\\bX_i\\).\nThe second term’s behavior determines the estimator’s overall properties, depending on whether strict exogeneity holds:\n\nIf strict exogeneity holds, the mean group estimator is unbiased and consistent for \\(\\E[\\bbeta_i]\\) even for \\(T\\) fixed. In this case it directly holds that \\[ \\E\\left[ \\left(\\bX_i'\\bX_i \\right)^{-1}\\bX_i'\\bu_i\\right] =0 \\] for any fixed value of \\(T\\).\nIf the model is dynamic or strict exogeneity fails for any other reason, the mean group estimator will typically only be consistent as both \\(N, T\\to\\infty\\). In this case it may be that \\[ \\E\\left[ \\left(\\bX_i'\\bX_i \\right)^{-1}\\bX_i'\\bu_i\\right] \\neq 0 ,\\] and \\(\\hat{\\bbeta}_{MG}\\) will be biased for any given finite \\(T\\). However, under standard assumptions that limit dependence across \\(t\\), this bias will typically be of the order \\(O(T^{-1})\\) and vanish as \\(T\\to\\infty\\).",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Mean Group: Robust Estimator for Average Coefficients</span>"
    ]
  },
  {
    "objectID": "linear-mean-group.html#comparing-estimators",
    "href": "linear-mean-group.html#comparing-estimators",
    "title": "7  Mean Group: Robust Estimator for Average Coefficients",
    "section": "7.2 Comparing Estimators",
    "text": "7.2 Comparing Estimators\n\n7.2.1 Conditions for Consistency\nWe now have have two estimation strategies per case. For the strictly exogenous case, we have within and mean group estimation. In the dynamic case, we can use dynamic panel IV estimators or again use the mean group estimators.\nThe following tables summarize and contrast the requirements for each estimation strategy to consistently estimate \\(\\E[\\bbeta_i]\\):\n\nStrict exogeneityDynamic model with \\(k\\) lags\n\n\n\n\n\n\n\n\n\n\n\nWithin\nMG\n\n\n\n\nData requirements\n\\(T \\geq 2\\)\n\\(T \\geq p\\)\n\n\nAssumptions on \\((\\beta_i, X_i)\\)\n\\(\\mathbb{E}[\\tilde{X}_i'\\tilde{X}_i\\eta_i]=0\\)\nNone\n\n\nAsymptotic framework\nFixed-\\(T\\)\nFixed-\\(T\\)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIV\nMG\n\n\n\n\nData requirements\n\\(T \\geq k+2\\)\n\\(T \\geq p+k\\)\n\n\nAssumptions on \\((\\beta_i, X_i)\\)\nNo consistency\nNone\n\n\nAsymptotic framework\nNo consistency\nLarge-\\((N, T)\\)\n\n\n\n\n\n\n\n\n7.2.2 Efficiency\nWhile the mean group estimator provides robustness to heterogeneity and dynamics, it is generally less efficient than alternative estimators when those alternatives are consistent. This loss of efficiency directly follows from the AM-HM inequality and is well-documented Hsiao, Pesaran, and Tahmiscioglu (1999).\nHowever, one might argue that this loss of efficiency is irrelevant, as the conditions for the consistency of alternatives require unrealistic restrictions on the coefficients. Still, there are some ways of obtaining a more efficient robust estimator, such as applying a Mundlak device, see Breitung and Salish (2021).",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Mean Group: Robust Estimator for Average Coefficients</span>"
    ]
  },
  {
    "objectID": "linear-mean-group.html#addressing-rank-deficiency",
    "href": "linear-mean-group.html#addressing-rank-deficiency",
    "title": "7  Mean Group: Robust Estimator for Average Coefficients",
    "section": "7.3 Addressing Rank Deficiency",
    "text": "7.3 Addressing Rank Deficiency\nBefore moving beyond \\(\\E[\\bbeta_i]\\), we return to the assumption that \\(\\bX_i'\\bX_i\\) is non-singular for all units \\(i\\). This requirement might not hold, in particular if \\(T\\) is only slightly larger than \\(p\\) and the model includes discrete regressors. In these cases, it is more likely that there exist units with insufficient individual variation.\nIf such a situation occurs in practice, a common solution is to drop the units with non-invertible \\(\\bX_i'\\bX_i\\). The mean group estimator is computed as an average over the remaining units. Formally, the corresponding mean group estimator is defined as \\[\n    \\hat{\\bbeta}_{MG}^+  = \\dfrac{1}{\\sum_{i=1}^N \\I\\curl{\\det(\\bX_i'\\bX_i)&gt;0} } \\sum_{i=1}^N \\I\\curl{\\det(\\bX_i'\\bX_i)&gt;0} \\hat{\\bbeta}_i.\n\\] Every unit is checked to see if \\(\\det(\\bX_i'\\bX_i)&gt;0\\). If it is, their \\(\\hat{\\bbeta}_i\\) is computed and added to the average.\nWhat does this modified estimator estimate? For simplicity, suppose that \\(\\E[\\bu_i|\\bX_i]=0\\). Then, as \\(N\\to\\infty\\), \\(\\hat{\\bbeta}_{MG}^+\\) converges to the average for the units that have enough variation in their data: \\[\n    \\hat{\\bbeta}_{MG}^+ \\to \\E\\left[\\bbeta_i| \\I\\curl{\\det(\\bX_i'\\bX_i)&gt;0}  \\right].\n\\] This limit may be viewed as an average treatment effect of the treated.\n\n\n\n\nBai, Yu, Massimiliano Marcellino, and George Kapetanios. 2023. “Mean Group Instrumental Variable Estimation of Time-varying Large Heterogeneous Panels With Endogenous Regressors.” Econometrics and Statistics, June, S2452306223000412. https://doi.org/10.1016/j.ecosta.2023.06.004.\n\n\nBreitung, Jörg, and Nazarii Salish. 2021. “Estimation of Heterogeneous Panels with Systematic Slope Variations.” Journal of Econometrics 220 (2): 399–415. https://doi.org/10.1016/j.jeconom.2020.04.007.\n\n\nHsiao, Cheng, M. Hashem Pesaran, and A. Kamil Tahmiscioglu. 1999. “Bayes Estimation of Short-Run Coefficients in Dynamic Panel Data Models.” In Analysis of Panels and Limited Dependent Variable Models, 268–96. https://doi.org/10.1017/cbo9780511493140.013.\n\n\nPesaran, Hashem, Ron Smith, and Kyung So Im. 1996. “Dynamic Linear Models for Heterogenous Panels.” In The Econometrics of Panel Data, edited by L. Matyas and P. Sevestre, 145–95. https://doi.org/10.1007/978-94-009-0137-7_8.\n\n\nPesaran, M. Hashem, Yongcheol Shin, and Ron P. Smith. 1999. “Pooled Mean Group Estimation of Dynamic Heterogeneous Panels.” Journal of the American Statistical Association 94 (446): 621–34. https://doi.org/10.1080/01621459.1999.10474156.\n\n\nPesaran, M. Hashem, and Ron P. Smith. 1995. “Estimating long-run relationships from dynamic heterogeneous panels.” Journal of Econometrics 6061: 473–77.",
    "crumbs": [
      "Linear Models",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Mean Group: Robust Estimator for Average Coefficients</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Ahn, Seung Chan, and Peter Schmidt. 1995. “Efficient Estimation of Models for Dynamic Panel\nData.” Journal of Econometrics 68 (1): 5–27. https://doi.org/10.1016/0304-4076(94)01641-C.\n\n\nAlvarez, Javier, and Manuel Arellano. 2003. “The Time Series and Cross-Section Asymptotics of Dynamic\nPanel Data Estimators.” Econometrica 71 (4):\n1121–59.\n\n\nAnderson, T. W., and Cheng Hsiao. 1982. “Formulation and estimation of dynamic models using panel\ndata.” Journal of Econometrics 18 (1): 47–82. https://doi.org/10.1016/0304-4076(82)90095-1.\n\n\nArellano, Manuel. 1989. “A note on the\nAnderson-Hsiao estimator for panel data.” Economics\nLetters 31 (4): 337–41. https://doi.org/10.1016/0165-1765(89)90025-6.\n\n\nArellano, Manuel, and Stephen Bond. 1991. “Some Tests of Specification for Panel Carlo Application\nto Data: Monte Carlo Evidence and an Application to Employment\nEquations.” Review of Economic Studies 58:\n277–97.\n\n\nArellano, Manuel, and Stéphane Bonhomme. 2012. “Identifying distributional characteristics in random\ncoefficients panel data models.” Review of Economic\nStudies 79 (3): 987–1020. https://doi.org/10.1093/restud/rdr045.\n\n\nBai, Yu, Massimiliano Marcellino, and George Kapetanios. 2023.\n“Mean Group Instrumental Variable Estimation of Time-varying Large Heterogeneous Panels With Endogenous\nRegressors.” Econometrics and Statistics, June,\nS2452306223000412. https://doi.org/10.1016/j.ecosta.2023.06.004.\n\n\nBester, C Alan, and Christian B Hansen. 2016. “Grouped Effects Estimators in Fixed Effects\nModels.” Journal of Econometrics 190 (1):\n197–208. https://doi.org/10.1016/j.jeconom.2012.08.022.\n\n\nBlundell, Richard, and Stephen Bond. 1998. “Initial Conditions and Moment Restrictions in Dynamic\nPanel Data Models.” Journal of Econometrics 87:\n115–43.\n\n\nBonhomme, Stéphane, Thibaut Lamadon, and Elena Manresa. 2022.\n“Discretizing Unobserved Heterogeneity.”\nEconometrica 90 (2): 625–43. https://doi.org/10.3982/ECTA15238.\n\n\nBonhomme, Stéphane, and Elena Manresa. 2015. “Grouped Patterns of Heterogeneity in Panel\nData.” Econometrica 83 (3): 1147–84. https://doi.org/10.3982/ecta11319.\n\n\nBreitung, Jörg, and Nazarii Salish. 2021. “Estimation of Heterogeneous Panels with Systematic Slope\nVariations.” Journal of Econometrics 220 (2):\n399–415. https://doi.org/10.1016/j.jeconom.2020.04.007.\n\n\nBrockwell, Peter J., and Richard A. Davis. 2016. Introduction to\nTime Series and Forecasting. Springer\nTexts in Statistics. Springer International\nPublishing.\n\n\nCampello, Murillo, Antonio F. Galvao, and Ted Juhl. 2019. “Testing for Slope Heterogeneity Bias in Panel Data\nModels.” Journal of Business and Economic\nStatistics 37 (4): 749–60. https://doi.org/10.1080/07350015.2017.1421545.\n\n\nCard, David. 2001. “Estimating the Return to\nSchooling: Progress on Some Persistent Econometric\nProblems.” Econometrica 69 (5): 1127–60. https://doi.org/10.1111/1468-0262.00237.\n\n\nCombes, Pierre Philippe, Gilles Duranton, Laurent Gobillon, Diego Puga,\nand Sébastien Roux. 2012. “The Productivity\nAdvantages of Large Cities: Distinguishing Agglomeration From Firm\nSelection.” Econometrica 80 (6): 2543–94. https://doi.org/10.3982/ecta8442.\n\n\nHansen, Bruce. 2022. Econometrics. Princeton University Press.\n\n\nHeckman, James, and Edward Vytlacil. 1998. “Instrumental variables methods for the correlated random\ncoefficient model.” Journal of Human Resources 33\n(4): 974–87.\n\n\nHoderlein, Stefan, Jussi Klemelä, and Enno Mammen. 2010. “Analyzing the Random Coefficient Model\nNonparametrically.” Econometric Theory 26 (03):\n804–37. https://doi.org/10.1017/S0266466609990119.\n\n\nKiviet, Jan F. 1995. “On Bias, Inconsistency,\nand Efficiency of Various Estimators in Dynamic Panel Data\nModels.” Journal of Econometrics 68 (1): 53–78.\nhttps://doi.org/10.1016/0304-4076(94)01643-E.\n\n\nMundlak, Yair. 1961. “Empirical Production Function\nFree of Management Bias.” Journal of Farm\nEconomics 43 (1): 44. https://doi.org/10.2307/1235460.\n\n\nMurtazashvili, Irina, and Jeffrey M. Wooldridge. 2008. “Fixed effects instrumental variables estimation in\ncorrelated random coefficient panel data models.”\nJournal of Econometrics 142 (1): 539–52. https://doi.org/10.1016/j.jeconom.2007.09.001.\n\n\nNickell, Stephen. 1981. “Biases In Dynamic Models With Fixed\nEffects.” Econometrica 49 (6): 1417–26.\n\n\nPesaran, Hashem, Ron Smith, and Kyung So Im. 1996. “Dynamic Linear Models for Heterogenous\nPanels.” In The Econometrics of Panel Data,\nedited by L. Matyas and P. Sevestre, 145–95. https://doi.org/10.1007/978-94-009-0137-7_8.\n\n\nPesaran, M. Hashem, and Ron P. Smith. 1995. “Estimating long-run relationships from dynamic\nheterogeneous panels.” Journal of Econometrics\n6061: 473–77.\n\n\nSury, Tavneet. 2011. “Selection and\nComparative Advantage in Technology Adoption.”\nEconometrica 79 (1): 159–209. https://doi.org/10.3982/ecta7749.\n\n\nWooldridge, Jeffrey M. 2003. “Fixed Effects\nEstimation of the Population-Averaged Slopes in a Panel Data Random\nCoefficient Model.” Econometric Theory 19:\n411–13. https://doi.org/10+10170S0266466603002081.\n\n\n———. 2005. “Fixed-effects and related\nestimators for correlated random-coefficient and treatment-effect panel\ndata models.” The Review of Economics and\nStatistics 87 (May): 385–90.",
    "crumbs": [
      "References"
    ]
  }
]