<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Learn about instrumental variable estimators for linear dynamic panels: Anderson-Hsiao, Arellano-Bond, and others. Lecture notes.">

<title>4&nbsp; Interlude: Standard Dynamic Panel Estimators – Econometrics with Unobserved Heterogeneity</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../linear/linear-dynamic-panel-heterogeneity.html" rel="next">
<link href="../linear/linear-within-estimator.html" rel="prev">
<link href="../themes/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-5d2b45bed95172e221bc55a94b858b1a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-d922cade42bc4f32e00ea3a44fd4d3b7.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
 

<!-- This is what works with Quarto and MathJax 3+ -->

<script>

  MathJax = {

    tex: {

      tags: 'ams',  // should be 'ams', 'none', or 'all'

      macros: {

        vect: ["\\mathbf{#1}", 1],

        mat: ["\\mathbf{#1}", 1], 



        bA: "\\boldsymbol{A}",

        bB: "\\boldsymbol{B}",

        bC: "\\boldsymbol{C}",

        bD: "\\boldsymbol{D}",

        bE: "\\boldsymbol{E}",

        bF: "\\boldsymbol{F}",

        bG: "\\boldsymbol{G}",

        bH: "\\boldsymbol{H}",

        bI: "\\boldsymbol{I}",

        bJ: "\\boldsymbol{J}",

        bK: "\\boldsymbol{K}",

        bL: "\\boldsymbol{L}",

        bM: "\\boldsymbol{M}",

        bN: "\\boldsymbol{N}",

        bP: "\\boldsymbol{P}",

        bQ: "\\boldsymbol{Q}",

        bR: "\\boldsymbol{R}",

        bS: "\\boldsymbol{S}",

        bT: "\\boldsymbol{T}",

        bU: "\\boldsymbol{U}",

        bV: "\\boldsymbol{V}",

        bW: "\\boldsymbol{W}",

        bX: "\\boldsymbol{X}",

        bY: "\\boldsymbol{Y}",

        bZ: "\\boldsymbol{Z}",

        ba: "\\boldsymbol{a}",

        bb: "\\boldsymbol{b}",

        bc: "\\boldsymbol{c}",

        bd: "\\boldsymbol{d}",

        be: "\\boldsymbol{e}",

        bg: "\\boldsymbol{g}",

        bh: "\\boldsymbol{h}",

        bi: "\\boldsymbol{\\imath}",

        bm: "\\boldsymbol{m}",

        bp: "\\boldsymbol{p}",

        bq: "\\boldsymbol{q}",

        br: "\\boldsymbol{r}",

        bs: "\\boldsymbol{s}",

        bt: "\\boldsymbol{t}",

        bu: "\\boldsymbol{u}",

        bv: "\\boldsymbol{v}",

        bw: "\\boldsymbol{w}",

        bx: "\\boldsymbol{x}",

        by: "\\boldsymbol{y}",



        Acal: "\\mathcal{A}",

        Bcal: "\\mathcal{B}",

        Ccal: "\\mathcal{C}",

        Dcal: "\\mathcal{D}",

        Ecal: "\\mathcal{E}",

        Fcal: "\\mathcal{F}",

        Gcal: "\\mathcal{G}",

        Hcal: "\\mathcal{H}",

        Ical: "\\mathcal{I}",

        Jcal: "\\mathcal{J}",

        Kcal: "\\mathcal{K}",

        Lcal: "\\mathcal{L}",

        Mcal: "\\mathcal{M}",

        Ncal: "\\mathcal{N}",

        Ocal: "\\mathcal{O}",

        Pcal: "\\mathcal{P}",

        Qcal: "\\mathcal{Q}",

        Rcal: "\\mathcal{R}",

        Scal: "\\mathcal{S}",

        Tcal: "\\mathcal{T}",

        Ucal: "\\mathcal{U}",

        Vcal: "\\mathcal{V}",

        Wcal: "\\mathcal{W}",

        Xcal: "\\mathcal{X}",

        Ycal: "\\mathcal{Y}",

        Zcal: "\\mathcal{Z}",



        A: "\\mathbb{A}",

        B: "\\mathbb{B}",

        C: "\\mathbb{C}",

        D: "\\mathbb{D}",

        E: "\\mathbb{E}",

        F: "\\mathbb{F}",

        G: "\\mathbb{G}",

        H: "\\mathbb{H}",

        I: "\\mathbb{I}",

        J: "\\mathbb{J}",

        K: "\\mathbb{K}",

        L: "\\mathbb{L}",

        M: "\\mathbb{M}",

        N: "\\mathbb{N}",

        O: "\\mathbb{O}",

        P: "\\mathbb{P}",

        Q: "\\mathbb{Q}",

        R: "\\mathbb{R}",

        S: "\\mathbb{S}",

        T: "\\mathbb{T}",

        U: "\\mathbb{U}",

        V: "\\mathbb{V}",

        W: "\\mathbb{W}",

        X: "\\mathbb{X}",

        Y: "\\mathbb{Y}",

        Z: "\\mathbb{Z}",



        bAlpha: "\\boldsymbol{\\Alpha}",

        bBeta: "\\boldsymbol{\\beta}",

        bDelta: "\\boldsymbol{\\delta}",

        bEta: "\\boldsymbol{\\eta}",

        bGamma: "\\boldsymbol{\\Gamma}",

        bLambda: "\\boldsymbol{\\Lambda}",

        bOmega: "\\boldsymbol{\\Omega}",

        bPhi: "\\boldsymbol{\\Phi}",

        bPi: "\\boldsymbol{\\Pi}",

        bPsi: "\\boldsymbol{\\Psi}",

        bSigma: "\\boldsymbol{\\Sigma}",

        bTau: "\\boldsymbol{\\tau}",

        bXi: "\\boldsymbol{\\Xi}",

        bbeta: "\\boldsymbol{\\beta}",

        bdelta: "\\boldsymbol{\\delta}",

        blambda: "\\boldsymbol{\\lambda}",

        bmu: "\\boldsymbol{\\mu}",

        bphi: "\\boldsymbol{\\phi}",

        bpi: "\\boldsymbol{\\pi}",

        bpsi: "\\boldsymbol{\\psi}",

        brho: "\\boldsymbol{\\rho}",

        bsigma: "\\boldsymbol{\\sigma}",

        btau: "\\boldsymbol{\\tau}",

        bxi: "\\boldsymbol{\\xi}",

        bEta: "\\boldsymbol{\\eta}",

        bPhi: "\\boldsymbol{\\Phi}",

        bPi: "\\boldsymbol{\\Pi}",

        bPsi: "\\boldsymbol{\\Psi}",

        bXi: "\\boldsymbol{\\Xi}",

        blambda: "\\boldsymbol{\\lambda}",

        bmu: "\\boldsymbol{\\mu}",

        bphi: "\\boldsymbol{\\phi}",

        bpi: "\\boldsymbol{\\pi}",

        bpsi: "\\boldsymbol{\\psi}",

        brho: "\\boldsymbol{\\rho}",

        bsigma: "\\boldsymbol{\\sigma}",

                   

        curl: ["\\left\\lbrace#1\\right\\rbrace", 1],

        floor: ["\\left\\lfloor#1\\right\\rfloor", 1],

        ceil: ["\\left\\lceil#1\\right\\rceil", 1],

        abs: ["\\left\\lvert#1\\right\\rvert", 1],

        norm: ["\\left\\lVert#1\\right\\rVert", 1],



        var: "\\mathrm{var}",

      }

    }

  };

</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="4&nbsp; Interlude: Standard Dynamic Panel Estimators – Econometrics with Unobserved Heterogeneity">
<meta property="og:description" content="Learn about instrumental variable estimators for linear dynamic panels: Anderson-Hsiao, Arellano-Bond, and others. Lecture notes.">
<meta property="og:site_name" content="Econometrics with Unobserved Heterogeneity">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../linear/linear-introduction.html">Linear Models</a></li><li class="breadcrumb-item"><a href="../linear/linear-dynamic-panel-iv.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interlude: Standard Dynamic Panel Estimators</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Econometrics with Unobserved Heterogeneity</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/vladislav-morozov/econometrics-heterogeneity/tree/main/src/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Information</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear/linear-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Intro: Linear Models with Heterogeneous Coefficients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear/linear-within-estimator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Within (Fixed Effects) Estimator and Heterogeneous Coefficients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear/linear-dynamic-panel-iv.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interlude: Standard Dynamic Panel Estimators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear/linear-dynamic-panel-heterogeneity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Heterogeneous Coefficient Dynamic Panels and Instrumental Variable Estimators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear/linear-mean-group.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Mean Group: Robust Estimator for Average Coefficients</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linear/linear-coefficient-variance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Variance of Heterogeneous Coefficients</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Nonparametrics and Heterogeneity</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Quantile and Distributional Methods</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#exogeneity-and-dynamic-models" id="toc-exogeneity-and-dynamic-models" class="nav-link active" data-scroll-target="#exogeneity-and-dynamic-models"><span class="header-section-number">4.1</span> Exogeneity and Dynamic Models</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">4.1.1</span> Introduction</a></li>
  <li><a href="#no-strict-exogeneity-for-dynamic-models" id="toc-no-strict-exogeneity-for-dynamic-models" class="nav-link" data-scroll-target="#no-strict-exogeneity-for-dynamic-models"><span class="header-section-number">4.1.2</span> No Strict Exogeneity for Dynamic Models</a></li>
  <li><a href="#sequential-exogeneity" id="toc-sequential-exogeneity" class="nav-link" data-scroll-target="#sequential-exogeneity"><span class="header-section-number">4.1.3</span> Sequential Exogeneity</a></li>
  </ul></li>
  <li><a href="#handling-dynamic-panels-with-a-random-intercept" id="toc-handling-dynamic-panels-with-a-random-intercept" class="nav-link" data-scroll-target="#handling-dynamic-panels-with-a-random-intercept"><span class="header-section-number">4.2</span> Handling Dynamic Panels with a Random Intercept</a>
  <ul class="collapse">
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model"><span class="header-section-number">4.2.1</span> Model</a></li>
  <li><a href="#endogeneity" id="toc-endogeneity" class="nav-link" data-scroll-target="#endogeneity"><span class="header-section-number">4.2.2</span> Endogeneity</a></li>
  </ul></li>
  <li><a href="#iv-estimation-of-dynamic-panel-models" id="toc-iv-estimation-of-dynamic-panel-models" class="nav-link" data-scroll-target="#iv-estimation-of-dynamic-panel-models"><span class="header-section-number">4.3</span> IV Estimation of Dynamic Panel Models</a>
  <ul class="collapse">
  <li><a href="#the-anderson-hsiao-estimator" id="toc-the-anderson-hsiao-estimator" class="nav-link" data-scroll-target="#the-anderson-hsiao-estimator"><span class="header-section-number">4.3.1</span> The Anderson-Hsiao Estimator</a></li>
  <li><a href="#further-dynamic-panel-iv-estimators" id="toc-further-dynamic-panel-iv-estimators" class="nav-link" data-scroll-target="#further-dynamic-panel-iv-estimators"><span class="header-section-number">4.3.2</span> Further Dynamic Panel IV Estimators</a></li>
  <li><a href="#properties-of-dynamic-panel-iv-estimators" id="toc-properties-of-dynamic-panel-iv-estimators" class="nav-link" data-scroll-target="#properties-of-dynamic-panel-iv-estimators"><span class="header-section-number">4.3.3</span> Properties of Dynamic Panel IV Estimators</a></li>
  </ul></li>
  <li><a href="#extra-endogeneity-and-the-within-estimator" id="toc-extra-endogeneity-and-the-within-estimator" class="nav-link" data-scroll-target="#extra-endogeneity-and-the-within-estimator"><span class="header-section-number">4.4</span> Extra: Endogeneity and the Within Estimator</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/vladislav-morozov/econometrics-heterogeneity/edit/main/src/linear/linear-dynamic-panel-iv.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/vladislav-morozov/econometrics-heterogeneity/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../linear/linear-introduction.html">Linear Models</a></li><li class="breadcrumb-item"><a href="../linear/linear-dynamic-panel-iv.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interlude: Standard Dynamic Panel Estimators</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interlude: Standard Dynamic Panel Estimators</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Summary and Learning Outcomes
</div>
</div>
<div class="callout-body-container callout-body">
<p>This section discusses why strict exogeneity fails in dynamic models and introduces the “workhorse” dynamic panel instrumental variable estimators.</p>
<p>By the end of this section, you should</p>
<ul>
<li>Understand why strict exogeneity fails in dynamic panel models.<br>
</li>
<li>Differentiate between strict and sequential exogeneity.<br>
</li>
<li>Explain the endogeneity problem in first-differenced and within estimators.<br>
</li>
<li>Describe IV-based solutions such as the <span class="citation" data-cites="Anderson1982">Anderson and Hsiao (<a href="../references/references.html#ref-Anderson1982" role="doc-biblioref">1982</a>)</span> and the <span class="citation" data-cites="Arellano1991">Arellano and Bond (<a href="../references/references.html#ref-Arellano1991" role="doc-biblioref">1991</a>)</span> estimators.<br>
</li>
</ul>
</div>
</div>
<section id="exogeneity-and-dynamic-models" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="exogeneity-and-dynamic-models"><span class="header-section-number">4.1</span> Exogeneity and Dynamic Models</h2>
<section id="introduction" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">4.1.1</span> Introduction</h3>
<p>Throughout the previous section, we assumed that the idiosyncratic term <span class="math inline">\(u_{it}\)</span> satisfied strict exogeneity with respect to the data: <span id="eq-dynamic-interlude-strict-orthogonality"><span class="math display">\[
    \E[u_{it}|\bX_i] = 0.
\tag{4.1}\]</span></span></p>
<p>However, strict exogeneity is not an innocent assumption. In particular, it implies that for all pairs of indices <span class="math inline">\(t, s\)</span> it holds that <span id="eq-dynamic-interlude-strict-orthogonality"><span class="math display">\[
    \E[u_{it}\bx_{is}] =0.
\tag{4.2}\]</span></span></p>
<p>For <span class="math inline">\(t&lt;s\)</span>, <a href="#eq-dynamic-interlude-strict-orthogonality" class="quarto-xref">Equation&nbsp;<span>4.2</span></a> means that <em>past</em> shocks are uncorrelated with <em>future</em> values of <span class="math inline">\(\bx\)</span>. In other words, one cannot predict <em>past</em> shocks from <em>future</em> <span class="math inline">\(\bx\)</span>s.</p>
<p>This requirement might fail if <span class="math inline">\(\bx\)</span> is dynamic and its evolution is affected by <span class="math inline">\(u_{it}\)</span>. In this section, we will discuss this challenge and some traditional approaches to dealing with it with short panel data.</p>
</section>
<section id="no-strict-exogeneity-for-dynamic-models" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="no-strict-exogeneity-for-dynamic-models"><span class="header-section-number">4.1.2</span> No Strict Exogeneity for Dynamic Models</h3>
<p>A particularly clear example for failure of <a href="#eq-dynamic-interlude-strict-orthogonality" class="quarto-xref">Equation&nbsp;<span>4.2</span></a> arises when <span class="math inline">\(\bx_{it}\)</span> includes lagged values of the outcome. As we show now, strict exogeneity cannot hold in this case.</p>
<p>For simplicity, we momentarily forget about the cross-sectional dimension and consider a simple autoregressive model with 1 lag (AR(1)): <span class="math display">\[
    y_t = \alpha + \lambda y_{t-1} + u_{t},
\]</span> where <span class="math inline">\(t=1, \dots, T\)</span> and the innovation <span class="math inline">\(u_t\)</span> satisfies <span class="math inline">\(\E[u_t]=0\)</span>.</p>
<p>To show that strict exogeneity fails, it is sufficient to find a single pair of <span class="math inline">\((t, s)\)</span> such that <a href="#eq-dynamic-interlude-strict-orthogonality" class="quarto-xref">Equation&nbsp;<span>4.2</span></a> is not true. Specifically, we will take <span class="math inline">\(s=t+1\)</span> and show that <span class="math inline">\(\E[y_{it+1}u_t]\)</span> is not necessarily zero.</p>
<p>To evaluate this expectation, we write the model at <span class="math inline">\(t+1\)</span> <span id="eq-dynamic-interlude-simple-ar1"><span class="math display">\[
    y_{t+1} = \alpha + \lambda y_t + u_{t+1}.
\tag{4.3}\]</span></span> We then substitute the model into <span class="math inline">\(\E[y_{it+1}u_t]\)</span> <span class="math display">\[
\begin{aligned}
    \E[y_{t+1}u_t] &amp; = \lambda\E[y_t u_t] + \E[u_{t+1}u_t] \\
    &amp;  = \lambda^2\E[y_{t-1}u_t] + \lambda\E[u_t^2] + \E[u_{t+1}u_t] .
\end{aligned}
\]</span></p>
<p>What can we say about the right hand side? In many contexts, we may reasonably assume that</p>
<ul>
<li>One cannot predict the shocks of tomorrow from what you have today, so that <span class="math display">\[\E[y_{t-1}u_t]=0.\]</span></li>
<li><span class="math inline">\(u_{t}\)</span> is uncorrelated over time, so that <span class="math display">\[\E[u_{t+1}u_t]=0.\]</span></li>
</ul>
<p>However, <span class="math inline">\(\lambda\E[u_t^2]\)</span> is zero only in two unreasonable cases:</p>
<ul>
<li>If <span class="math inline">\(\lambda=0\)</span>, and so the model is not actually dynamic</li>
<li><span class="math inline">\(\E[u_t^2]=0\)</span>, and so the process is actually fully deterministic.</li>
</ul>
<p>Both of these options are unpleasant. The first one goes against the idea of allowing any dynamics. The second is extremely unlikely with any kind of social data. We conclude that in dynamic models it is the case <span id="eq-dynamic-interlude-no-strict-exogeneity"><span class="math display">\[
\E[y_{it+1}u_t] \neq 0.
\tag{4.4}\]</span></span> A fortiori, strict exogeneity also cannot hold in dynamic models.</p>
</section>
<section id="sequential-exogeneity" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="sequential-exogeneity"><span class="header-section-number">4.1.3</span> Sequential Exogeneity</h3>
<p>So what can you do if you want to allow for dynamic models? Since strict exogeneity (<a href="#eq-dynamic-interlude-strict-orthogonality" class="quarto-xref"><span>4.2</span></a>) is effectively impossible to satisfy, we need a weaker form of exogeneity.</p>
<p>One popular weaker assumption compatible with dynamic models is <em>sequential exogeneity</em> (or <em>predeterminedness</em>). In context of the simple univariate time series model (<a href="#eq-dynamic-interlude-simple-ar1" class="quarto-xref"><span>4.3</span></a>), sequential exogeneity may be stated as <span class="math display">\[
        \E[u_{t}| y_{t-1}, y_{t-2}, \dots] =0.
\]</span> Intuitively, sequential exogeneity states that future shocks cannot be predicted using past covariates. However, it does not restrict our ability to predict the past from the future — the context which created problems for strict exogeneity.</p>
<p>More generally, consider a panel data linear model with homogeneous coefficients, a random intercept, and a dynamic process for the outcome: <span id="eq-dynamic-interlude-dynamic-panel"><span class="math display">\[
y_{it} = \alpha_i + \sum_{k=1}^K \lambda_k y_{it-k} + \bbeta'\bx_{it} + u_{it}.  
\tag{4.5}\]</span></span> In this model, a sequential exogeneity assumption takes form <span class="math display">\[
     \E[u_{it}|\curl{y_{is-1}, \bx_{is}}_{s\leq t}] =0.
\]</span> Model (<a href="#eq-dynamic-interlude-dynamic-panel" class="quarto-xref"><span>4.5</span></a>) is a dynamic counterpart of the static model (<a href="linear-within-estimator.html#eq-within-lecture-random-intercept" class="quarto-xref"><span>3.2</span></a>) we discussed in the last section.</p>
</section>
</section>
<section id="handling-dynamic-panels-with-a-random-intercept" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="handling-dynamic-panels-with-a-random-intercept"><span class="header-section-number">4.2</span> Handling Dynamic Panels with a Random Intercept</h2>
<p>Before moving on and introducing heterogeneous coefficients in dynamic linear models, we will discuss model (<a href="#eq-dynamic-interlude-dynamic-panel" class="quarto-xref"><span>4.5</span></a>) in more detail. In particular, we will develop the standard workhorse instrumental variable estimators. We will analyze how these estimators fare in the more general model (<a href="linear-introduction.html#eq-lecture_model" class="quarto-xref"><span>2.7</span></a>) in the next section.</p>
<section id="model" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="model"><span class="header-section-number">4.2.1</span> Model</h3>
<p>For the sake of simplicity, we will discuss a simple version of model (<a href="#eq-dynamic-interlude-dynamic-panel" class="quarto-xref"><span>4.5</span></a>) without extra covariates <span class="math inline">\(\bx_{it}\)</span> and with only one lag of <span class="math inline">\(y_{it}\)</span>: <span id="eq-dynamic-interlude-dynamic-simple"><span class="math display">\[
y_{it} = \alpha_i + \lambda y_{it-1} + u_{it},
\tag{4.6}\]</span></span> where <span class="math inline">\(u_{it}\)</span> satisfies sequential exogeneity in the form <span class="math inline">\(\E[u_{it}|y_{is}, s&lt;t] = 0\)</span>. This random intercept dynamic model has extensively considered in the literature <span class="citation" data-cites="Anderson1982 Arellano1991 Blundell1998">(e.g. <a href="../references/references.html#ref-Anderson1982" role="doc-biblioref">Anderson and Hsiao 1982</a>; <a href="../references/references.html#ref-Arellano1991" role="doc-biblioref">Arellano and Bond 1991</a>; <a href="../references/references.html#ref-Blundell1998" role="doc-biblioref">Blundell and Bond 1998</a>)</span>.</p>
<p>The key parameter of interest is <span class="math inline">\(\lambda\)</span>. By homogeneity of <span class="math inline">\(\lambda\)</span>, it also plays the role of the average coefficient for model (<a href="#eq-dynamic-interlude-dynamic-simple" class="quarto-xref"><span>4.6</span></a>).</p>
<p>Here, we will primarily focus on the large-<span class="math inline">\(N\)</span>, fixed-<span class="math inline">\(T\)</span> case, though model (<a href="#eq-dynamic-interlude-dynamic-panel" class="quarto-xref"><span>4.5</span></a>) has also been extensively studied in the large-(<span class="math inline">\(N, T\)</span>) case <span class="citation" data-cites="Alvarez2003">(e.g. <a href="../references/references.html#ref-Alvarez2003" role="doc-biblioref">Alvarez and Arellano 2003</a>)</span>.</p>
</section>
<section id="endogeneity" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="endogeneity"><span class="header-section-number">4.2.2</span> Endogeneity</h3>
<p>To work towards an estimator for <span class="math inline">\(\lambda\)</span>, let us difference <a href="#eq-dynamic-interlude-dynamic-panel" class="quarto-xref">Equation&nbsp;<span>4.5</span></a> across <span class="math inline">\(t\)</span> to eliminate the random intercept <span class="math inline">\(\alpha_i\)</span>. The differenced equation takes form <span id="eq-dynamic-interlude-homogeneous-differenced"><span class="math display">\[
\begin{aligned}
\Delta y_{it} &amp; = \lambda \Delta y_{it-1} + \Delta u_{it}, \\
\Delta y_{it} &amp; = y_{it} - y_{it-1}.
\end{aligned}
\tag{4.7}\]</span></span> <a href="#eq-dynamic-interlude-homogeneous-differenced" class="quarto-xref">Equation&nbsp;<span>4.7</span></a> seems like a simple regression equation. It is tempting to just apply OLS and regress <span class="math inline">\(\Delta y_{it}\)</span> on <span class="math inline">\(\Delta y_{it-1}\)</span>.</p>
<p>It turns out that this approach will fail as there is an endogeneity problem in <a href="#eq-dynamic-interlude-homogeneous-differenced" class="quarto-xref">Equation&nbsp;<span>4.7</span></a>! Sequential exogeneity is not enough to guarantee that <span class="math display">\[
\E[\Delta y_{it-1}\Delta u_{it}] = 0.
\]</span></p>
<p>To see why, we expand <span class="math inline">\(\E[\Delta y_{it-1}\Delta u_{it}]\)</span> as<br>
<span class="math display">\[
\begin{aligned}
    &amp; \E\left[(u_{it}-u_{it-1})(y_{it-1}-y_{it-2}) \right] \\
    &amp; = \E[ u_{it}y_{it-1} ] + \E[(u_{it-1}-u_{it})y_{it-2}] - \E[u_{it-1}y_{it-1}]  \\
    &amp; = -\E[u_{it-1} y_{it-1}].
\end{aligned}
\]</span> Sequential exogeneity is sufficient to immediately eliminate the first 2 expectations. For the last expectation remaining, we can substitute <span class="math inline">\(y_{it-1}\)</span> to see that <span class="math display">\[
\begin{aligned}
    \E[u_{it-1}y_{it-1}] &amp; = \lambda\E[u_{it-1}y_{it-2}] + \E[u_{it-1}^2]\\
    &amp; = \E[u_{it-1}^2]
\end{aligned}
\]</span> As noted above, in general we expect that <span class="math inline">\(\E[u_{it-1}^2] \neq 0\)</span>. Hence we conclude that <span id="eq-dynamic-interlude-differenced-endogeneity"><span class="math display">\[
    \E[\Delta y_{it-1}\Delta u_{it}]\neq 0.
\tag{4.8}\]</span></span> In other words, <span class="math inline">\(\Delta y_{it-1}\)</span> is an endogenous regressor in the differenced <a href="#eq-dynamic-interlude-homogeneous-differenced" class="quarto-xref">Equation&nbsp;<span>4.7</span></a>.</p>
<div class="callout callout-style-simple callout-caution no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>One should not confuse endogeneity in <a href="#eq-dynamic-interlude-differenced-endogeneity" class="quarto-xref">Equation&nbsp;<span>4.8</span></a> with the failure of <em>strict</em> but not necessarily sequential exogeneity in dynamic models (e.g. <a href="#eq-dynamic-interlude-no-strict-exogeneity" class="quarto-xref">Equation&nbsp;<span>4.4</span></a>).</p>
</div>
</div>
</div>
</section>
</section>
<section id="iv-estimation-of-dynamic-panel-models" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="iv-estimation-of-dynamic-panel-models"><span class="header-section-number">4.3</span> IV Estimation of Dynamic Panel Models</h2>
<p>Given the endogeneity issue in first-differencing, instrumental variable methods offer a potential solution. We only need to find suitable instruments — variables <span class="math inline">\(z_{it}\)</span> which satisfy relevance and exogeneity conditions: <span class="math display">\[
\begin{aligned}
    \E[z_{it}\Delta y_{it-1}] \neq 0,\\
    \E[z_{it}\Delta u_{it}] = 0.
\end{aligned}
\]</span></p>
<p>In most contexts, one has to look for external variables that can serve as instruments.</p>
<p>However, <a href="#eq-dynamic-interlude-homogeneous-differenced" class="quarto-xref">Equation&nbsp;<span>4.7</span></a> is a very special case where one can use instruments internal to the model!</p>
<section id="the-anderson-hsiao-estimator" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="the-anderson-hsiao-estimator"><span class="header-section-number">4.3.1</span> The Anderson-Hsiao Estimator</h3>
<p>In particular, consider using <span class="math inline">\(y_{it-2}\)</span> as an instrument.</p>
<ul>
<li>Relevance seems to be relatively straightforward, as the target endogenous variable <span class="math inline">\(\Delta y_{it-1}= y_{it-1}-y_{it-2}\)</span> actually has the instrument inside.</li>
<li>Exogeneity can be justified by appealing to sequential exogeneity: <span class="math display">\[ \E[y_{it-2}\Delta u_{it}]  = \E[y_{it-2}u_{it} - y_{it-2}u_{it-1}]=0. \]</span></li>
</ul>
<p>Hence <span class="math inline">\(y_{it-2}\)</span> is a valid instrument!</p>
<p>The resulting IV estimator is known as the <span class="citation" data-cites="Anderson1982">Anderson and Hsiao (<a href="../references/references.html#ref-Anderson1982" role="doc-biblioref">1982</a>)</span> estimator and given by <span class="math display">\[
\hat{\lambda}^{AH} = \dfrac{ \sum_{t=2}^T y_{it-2}\Delta y_{it} }{\sum_{t=2}^T y_{it-2}\Delta y_{it} }.
\]</span></p>
</section>
<section id="further-dynamic-panel-iv-estimators" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="further-dynamic-panel-iv-estimators"><span class="header-section-number">4.3.2</span> Further Dynamic Panel IV Estimators</h3>
<p>Are there more instruments that can use for <span class="math inline">\(\Delta y_{it-1}\)</span>? Using more instruments will induce overidentification and potentially lead to more precise estimators, solving one of the key drawbacks of the <span class="citation" data-cites="Anderson1982">Anderson and Hsiao (<a href="../references/references.html#ref-Anderson1982" role="doc-biblioref">1982</a>)</span> estimator <span class="citation" data-cites="Arellano1989">(<a href="../references/references.html#ref-Arellano1989" role="doc-biblioref">Arellano 1989</a>)</span>.</p>
<p>As a partial answer, suppose we consider <span class="math inline">\(y_{it-k}\)</span> for <span class="math inline">\(k\geq 2\)</span>. By applying sequential exogeneity again we can show that <span class="math inline">\(y_{it-k}\)</span> is exogenous: <span class="math display">\[  
\E[y_{it-k}\Delta u_{it}]  = \E[y_{it-k}u_{it} - y_{it-k}u_{it-1}]=0.
\]</span> Provided <span class="math inline">\(y_{it-k}\)</span> is correlated with <span class="math inline">\(\Delta y_{it-1}\)</span> and available in the data, it also becomes a valid instrument. Following this chain of reasoning and using all available lags <span class="math inline">\(y_{it-k}\)</span> yields the <span class="citation" data-cites="Arellano1991">Arellano and Bond (<a href="../references/references.html#ref-Arellano1991" role="doc-biblioref">1991</a>)</span> estimator.</p>
<p>Even further instruments have been found for <a href="#eq-dynamic-interlude-homogeneous-differenced" class="quarto-xref">Equation&nbsp;<span>4.7</span></a> by <span class="citation" data-cites="Ahn1995">Ahn and Schmidt (<a href="../references/references.html#ref-Ahn1995" role="doc-biblioref">1995</a>)</span> and <span class="citation" data-cites="Blundell1998">Blundell and Bond (<a href="../references/references.html#ref-Blundell1998" role="doc-biblioref">1998</a>)</span>, among others.</p>
<p>All of these estimators are implemented in</p>
<ul>
<li>R: <a href="https://cran.r-project.org/web/packages/plm/index.html%7D">plm</a>.</li>
<li>Python: <a href="https://github.com/dazhwu/pydynpd/">pydynpd</a>.</li>
</ul>
</section>
<section id="properties-of-dynamic-panel-iv-estimators" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="properties-of-dynamic-panel-iv-estimators"><span class="header-section-number">4.3.3</span> Properties of Dynamic Panel IV Estimators</h3>
<p>Under some standard conditions, the above instrumental variable estimators will all be consistent and asymptotically normal for <span class="math inline">\(\lambda\)</span> as <span class="math inline">\(N\to\infty\)</span> and <span class="math inline">\(T\)</span> is fixed. The matter is rather more delicate if both <span class="math inline">\(N\)</span> and <span class="math inline">\(T\)</span> are large, and the above dynamic panel IV estimators offer an interesting and natural example of the <em>many moments</em> bias. See <span class="citation" data-cites="Alvarez2003">Alvarez and Arellano (<a href="../references/references.html#ref-Alvarez2003" role="doc-biblioref">2003</a>)</span>.</p>
</section>
</section>
<section id="extra-endogeneity-and-the-within-estimator" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="extra-endogeneity-and-the-within-estimator"><span class="header-section-number">4.4</span> Extra: Endogeneity and the Within Estimator</h2>
<p>One may think that we had the endogeneity problem (<a href="#eq-dynamic-interlude-differenced-endogeneity" class="quarto-xref"><span>4.8</span></a>) because we took first differences instead of applying the within transformation.</p>
<p>However, the same issue endogeneity issue affects the within estimator. First, for <span class="math inline">\(T=2\)</span> the above discussion applies directly, as the within transformation is numerically identical to first differencing. Second, more generally, the within estimator will suffer from its own version of endogeneity. To see the issue, note that the within-transformed model (<a href="#eq-dynamic-interlude-dynamic-simple" class="quarto-xref"><span>4.6</span></a>) can be written as (see <a href="linear-within-estimator.html#eq-within_transformed" class="quarto-xref">Equation&nbsp;<span>3.3</span></a>): <span class="math display">\[
    \tilde{y}_{it} = \lambda \tilde{y}_{it-1} + \tilde{u}_{it}.
\]</span></p>
<p>One can now immediately see that <span class="math inline">\(\tilde{y}_{it-1}\)</span> will also be an endogenous regressor as</p>
<p><span class="math display">\[
    \E[\tilde{y}_{it-1}\tilde{u}_{it}] = \E\left[\left(y_{it-1}- T^{-1}\sum_{s=0}^{T-1} y_{is} \right)\left(u_{it} - T^{-1}\sum_{r=1}^{T}u_{ir} \right) \right].
\]</span></p>
<p>The expectation on the right hand side contains “bad” expectations of the form <span class="math inline">\(\E[u_{it}y_{is}]\)</span> with <span class="math inline">\(t&lt;s\)</span> (recall <a href="#eq-dynamic-interlude-no-strict-exogeneity" class="quarto-xref">Equation&nbsp;<span>4.4</span></a>).</p>
<p>We conclude that for any fixed <span class="math inline">\(T\)</span> the within estimator will also suffer from endogeneity bias. <span class="citation" data-cites="Nickell1981">Nickell (<a href="../references/references.html#ref-Nickell1981" role="doc-biblioref">1981</a>)</span> shows that it is of the order <span class="math inline">\(O(T^{-1})\)</span>. Furthermore, this bias is likely to be large in practice <span class="citation" data-cites="Kiviet1995">(see <a href="../references/references.html#ref-Kiviet1995" role="doc-biblioref">Kiviet 1995</a>)</span>.</p>
<hr>
<section id="next-section" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="next-section">Next Section</h4>
<p>Next, we examine how the above “standard” dynamic panel IV estimators break down when individual coefficients vary across observations.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Ahn1995" class="csl-entry" role="listitem">
Ahn, Seung Chan, and Peter Schmidt. 1995. <span>“<span class="nocase">Efficient Estimation of Models for Dynamic Panel Data</span>.”</span> <em>Journal of Econometrics</em> 68 (1): 5–27. <a href="https://doi.org/10.1016/0304-4076(94)01641-C">https://doi.org/10.1016/0304-4076(94)01641-C</a>.
</div>
<div id="ref-Alvarez2003" class="csl-entry" role="listitem">
Alvarez, Javier, and Manuel Arellano. 2003. <span>“<span class="nocase">The Time Series and Cross-Section Asymptotics of Dynamic Panel Data Estimators</span>.”</span> <em>Econometrica</em> 71 (4): 1121–59.
</div>
<div id="ref-Anderson1982" class="csl-entry" role="listitem">
Anderson, T. W., and Cheng Hsiao. 1982. <span>“<span class="nocase">Formulation and estimation of dynamic models using panel data</span>.”</span> <em>Journal of Econometrics</em> 18 (1): 47–82. <a href="https://doi.org/10.1016/0304-4076(82)90095-1">https://doi.org/10.1016/0304-4076(82)90095-1</a>.
</div>
<div id="ref-Arellano1989" class="csl-entry" role="listitem">
Arellano, Manuel. 1989. <span>“<span class="nocase">A note on the Anderson-Hsiao estimator for panel data</span>.”</span> <em>Economics Letters</em> 31 (4): 337–41. <a href="https://doi.org/10.1016/0165-1765(89)90025-6">https://doi.org/10.1016/0165-1765(89)90025-6</a>.
</div>
<div id="ref-Arellano1991" class="csl-entry" role="listitem">
Arellano, Manuel, and Stephen Bond. 1991. <span>“<span class="nocase">Some Tests of Specification for Panel Carlo Application to Data: Monte Carlo Evidence and an Application to Employment Equations</span>.”</span> <em>Review of Economic Studies</em> 58: 277–97.
</div>
<div id="ref-Blundell1998" class="csl-entry" role="listitem">
Blundell, Richard, and Stephen Bond. 1998. <span>“<span class="nocase">Initial Conditions and Moment Restrictions in Dynamic Panel Data Models</span>.”</span> <em>Journal of Econometrics</em> 87: 115–43.
</div>
<div id="ref-Kiviet1995" class="csl-entry" role="listitem">
Kiviet, Jan F. 1995. <span>“<span class="nocase">On Bias, Inconsistency, and Efficiency of Various Estimators in Dynamic Panel Data Models</span>.”</span> <em>Journal of Econometrics</em> 68 (1): 53–78. <a href="https://doi.org/10.1016/0304-4076(94)01643-E">https://doi.org/10.1016/0304-4076(94)01643-E</a>.
</div>
<div id="ref-Nickell1981" class="csl-entry" role="listitem">
Nickell, Stephen. 1981. <span>“<span>Biases In Dynamic Models With Fixed Effects</span>.”</span> <em>Econometrica</em> 49 (6): 1417–26.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/vladislav-morozov\.github\.io\/econometrics-heterogeneity\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../linear/linear-within-estimator.html" class="pagination-link" aria-label="Within (Fixed Effects) Estimator and Heterogeneous Coefficients">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Within (Fixed Effects) Estimator and Heterogeneous Coefficients</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../linear/linear-dynamic-panel-heterogeneity.html" class="pagination-link" aria-label="Heterogeneous Coefficient Dynamic Panels and Instrumental Variable Estimators">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Heterogeneous Coefficient Dynamic Panels and Instrumental Variable Estimators</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/vladislav-morozov/econometrics-heterogeneity/edit/main/src/linear/linear-dynamic-panel-iv.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/vladislav-morozov/econometrics-heterogeneity/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>